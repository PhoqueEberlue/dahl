#include "starpu_data_interfaces.h"
#include "tests.h"

#include "../include/dahl_convolution.h"
#include <stdio.h>

// First image of the fashion mnist dataset, with one dimension
static constexpr dahl_fp sample[1][1][28][28] = {{{
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.000000, 0.000000, 0.050980, 0.286275, 0.000000, 0.000000, 0.003922, 0.015686, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.003922, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.011765, 0.000000, 0.141176, 0.533333, 0.498039, 0.243137, 0.211765, 0.000000, 0.000000, 0.000000, 0.003922, 0.011765, 0.015686, 0.000000, 0.000000, 0.011765 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.023529, 0.000000, 0.400000, 0.800000, 0.690196, 0.525490, 0.564706, 0.482353, 0.090196, 0.000000, 0.000000, 0.000000, 0.000000, 0.047059, 0.039216, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.607843, 0.925490, 0.811765, 0.698039, 0.419608, 0.611765, 0.631373, 0.427451, 0.250980, 0.090196, 0.301961, 0.509804, 0.282353, 0.058824 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.000000, 0.270588, 0.811765, 0.874510, 0.854902, 0.847059, 0.847059, 0.639216, 0.498039, 0.474510, 0.478431, 0.572549, 0.552941, 0.345098, 0.674510, 0.258824 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.003922, 0.003922, 0.000000, 0.784314, 0.909804, 0.909804, 0.913725, 0.898039, 0.874510, 0.874510, 0.843137, 0.835294, 0.643137, 0.498039, 0.482353, 0.768627, 0.898039, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.717647, 0.882353, 0.847059, 0.874510, 0.894118, 0.921569, 0.890196, 0.878431, 0.870588, 0.878431, 0.866667, 0.874510, 0.960784, 0.678431, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.756863, 0.894118, 0.854902, 0.835294, 0.776471, 0.705882, 0.831373, 0.823529, 0.827451, 0.835294, 0.874510, 0.862745, 0.952941, 0.792157, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.011765, 0.000000, 0.047059, 0.858824, 0.862745, 0.831373, 0.854902, 0.752941, 0.662745, 0.890196, 0.815686, 0.854902, 0.878431, 0.831373, 0.886275, 0.772549, 0.819608, 0.203922 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.023529, 0.000000, 0.388235, 0.956863, 0.870588, 0.862745, 0.854902, 0.796078, 0.776471, 0.866667, 0.843137, 0.835294, 0.870588, 0.862745, 0.960784, 0.466667, 0.654902, 0.219608 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.015686, 0.000000, 0.000000, 0.215686, 0.925490, 0.894118, 0.901961, 0.894118, 0.941176, 0.909804, 0.835294, 0.854902, 0.874510, 0.917647, 0.850980, 0.850980, 0.819608, 0.360784, 0.000000 },
    { 0.000000, 0.000000, 0.003922, 0.015686, 0.023529, 0.027451, 0.007843, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.929412, 0.886275, 0.850980, 0.874510, 0.870588, 0.858824, 0.870588, 0.866667, 0.847059, 0.874510, 0.898039, 0.843137, 0.854902, 1.000000, 0.301961, 0.000000 },
    { 0.000000, 0.011765, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.243137, 0.568627, 0.800000, 0.894118, 0.811765, 0.835294, 0.866667, 0.854902, 0.815686, 0.827451, 0.854902, 0.878431, 0.874510, 0.858824, 0.843137, 0.878431, 0.956863, 0.623529, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.070588, 0.172549, 0.321569, 0.419608, 0.741176, 0.894118, 0.862745, 0.870588, 0.850980, 0.886275, 0.784314, 0.803922, 0.827451, 0.901961, 0.878431, 0.917647, 0.690196, 0.737255, 0.980392, 0.972549, 0.913725, 0.933333, 0.843137, 0.000000 },
    { 0.000000, 0.223529, 0.733333, 0.815686, 0.878431, 0.866667, 0.878431, 0.815686, 0.800000, 0.839216, 0.815686, 0.819608, 0.784314, 0.623529, 0.960784, 0.756863, 0.807843, 0.874510, 1.000000, 1.000000, 0.866667, 0.917647, 0.866667, 0.827451, 0.862745, 0.909804, 0.964706, 0.000000 },
    { 0.011765, 0.792157, 0.894118, 0.878431, 0.866667, 0.827451, 0.827451, 0.839216, 0.803922, 0.803922, 0.803922, 0.862745, 0.941176, 0.313725, 0.588235, 1.000000, 0.898039, 0.866667, 0.737255, 0.603922, 0.749020, 0.823529, 0.800000, 0.819608, 0.870588, 0.894118, 0.882353, 0.000000 },
    { 0.384314, 0.913725, 0.776471, 0.823529, 0.870588, 0.898039, 0.898039, 0.917647, 0.976471, 0.862745, 0.760784, 0.843137, 0.850980, 0.945098, 0.254902, 0.286275, 0.415686, 0.458824, 0.658824, 0.858824, 0.866667, 0.843137, 0.850980, 0.874510, 0.874510, 0.878431, 0.898039, 0.113725 },
    { 0.294118, 0.800000, 0.831373, 0.800000, 0.756863, 0.803922, 0.827451, 0.882353, 0.847059, 0.725490, 0.772549, 0.807843, 0.776471, 0.835294, 0.941176, 0.764706, 0.890196, 0.960784, 0.937255, 0.874510, 0.854902, 0.831373, 0.819608, 0.870588, 0.862745, 0.866667, 0.901961, 0.262745 },
    { 0.188235, 0.796078, 0.717647, 0.760784, 0.835294, 0.772549, 0.725490, 0.745098, 0.760784, 0.752941, 0.792157, 0.839216, 0.858824, 0.866667, 0.862745, 0.925490, 0.882353, 0.847059, 0.780392, 0.807843, 0.729412, 0.709804, 0.694118, 0.674510, 0.709804, 0.803922, 0.807843, 0.450980 },
    { 0.000000, 0.478431, 0.858824, 0.756863, 0.701961, 0.670588, 0.717647, 0.768627, 0.800000, 0.823529, 0.835294, 0.811765, 0.827451, 0.823529, 0.784314, 0.768627, 0.760784, 0.749020, 0.764706, 0.749020, 0.776471, 0.752941, 0.690196, 0.611765, 0.654902, 0.694118, 0.823529, 0.360784 },
    { 0.000000, 0.000000, 0.290196, 0.741176, 0.831373, 0.749020, 0.686275, 0.674510, 0.686275, 0.709804, 0.725490, 0.737255, 0.741176, 0.737255, 0.756863, 0.776471, 0.800000, 0.819608, 0.823529, 0.823529, 0.827451, 0.737255, 0.737255, 0.760784, 0.752941, 0.847059, 0.666667, 0.000000 },
    { 0.007843, 0.000000, 0.000000, 0.000000, 0.258824, 0.784314, 0.870588, 0.929412, 0.937255, 0.949020, 0.964706, 0.952941, 0.956863, 0.866667, 0.862745, 0.756863, 0.749020, 0.701961, 0.713725, 0.713725, 0.709804, 0.690196, 0.650980, 0.658824, 0.388235, 0.227451, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.156863, 0.239216, 0.172549, 0.282353, 0.160784, 0.137255, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
}}};

// Class of the first sample, here in categorical format
static constexpr dahl_fp img_targets[1][10] = {{
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000
}};

static constexpr dahl_fp expect_conv_forward[1][1][23][23] = {{
    {
        { 0.464870, 0.436084, 0.713466, 0.000000, 0.000000, 0.000000, 0.000000, 0.956951, 0.769605, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.411431, 0.416501, 0.872151, 0.499443, 0.808694, 0.000000, 0.000000 },
        { 0.812104, 0.117336, 0.734616, 0.000000, 0.000000, 0.000000, 0.000000, 0.655547, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.436628, 0.000000, 0.000000, 0.618658 },
        { 0.954936, 0.000000, 0.000000, 0.053940, 0.366463, 0.000000, 0.000000, 0.546050, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.258591, 0.000000, 0.978046, 0.051055, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.275288, 0.000000, 0.008780, 0.766518, 0.000000, 0.000000, 0.237514, 0.000000, 0.190605, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.673414, 0.000000, 0.207221, 0.989426, 0.000000, 0.000000, 0.139208, 0.000000, 0.308626, 0.000000, 0.000000, 0.000000, 0.287158, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.231980, 0.232828, 0.000000, 0.356449, 0.000000, 0.671973, 0.397984, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.204305, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.558727, 0.047361, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.082144, 0.241251, 0.000000, 0.557578, 0.808425, 0.587898, 0.335996, 0.231596, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.144065 },
        { 0.000000, 0.334494, 0.000000, 0.000000, 0.856323, 0.822436, 0.449884, 0.000000, 0.000000, 0.000000, 0.000000, 0.031620, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.304786, 0.000000, 0.000000, 0.082538, 0.722334, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.299114, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.103065, 0.000000, 0.000000, 0.000000, 0.000000, 0.364635, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.030976, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.010995, 0.279604, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.006596, 0.070440, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.565649 },
        { 1.343892, 2.505369, 0.265548, 0.493815, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.204690, 0.277272, 0.000000, 0.000000, 0.000000 },
        { 0.399898, 0.000000, 0.621415, 0.994411, 1.984232, 0.413756, 1.447631, 0.243458, 0.260187, 0.010316, 1.424735, 1.276091, 0.090977, 1.018132, 1.519731, 0.623967, 2.097321, 2.039105, 1.627757, 1.372993, 0.751707, 0.000000, 1.419587 },
        { 0.021613, 0.000000, 0.000000, 0.000000, 0.222828, 1.099793, 0.169066, 0.873382, 0.621826, 1.463076, 0.000000, 0.000000, 1.283302, 0.923474, 0.898022, 0.000000, 0.000000, 1.053039, 1.116091, 1.105049, 0.683973, 0.000000, 0.001810 },
    },
    {
        { 0.343168, 0.000000, 0.916219, 0.275164, 0.000000, 0.000000, 0.879745, 0.000000, 0.272763, 0.686613, 0.538463, 1.589147, 0.160657, 0.000000, 0.917371, 0.000000, 0.460156, 0.000000, 0.027609, 0.000000, 0.583187, 0.222469, 0.000000 },
        { 0.234180, 0.000000, 0.000000, 0.792094, 0.356054, 0.691122, 0.000000, 0.000000, 0.000000, 1.448550, 1.790658, 0.042432, 0.113185, 0.000000, 0.865509, 1.640169, 0.742491, 0.718450, 0.000000, 0.171919, 0.011519, 0.657301, 0.000000 },
        { 0.127696, 0.000000, 0.588846, 0.914177, 0.000000, 0.913372, 0.186103, 0.000000, 0.944099, 0.847599, 1.292712, 1.214445, 0.399180, 0.000000, 0.000000, 0.996768, 0.805274, 0.000000, 0.000000, 0.193513, 0.424818, 0.955959, 0.083787 },
        { 0.383044, 0.000000, 0.000000, 0.018633, 0.807525, 0.062643, 0.223506, 0.000000, 0.000000, 1.543851, 0.337031, 0.137661, 0.000000, 0.000000, 0.570990, 1.628806, 0.251121, 1.263085, 0.031741, 1.169013, 1.769546, 1.309024, 0.677191 },
        { 0.704294, 0.891721, 0.839815, 0.000000, 0.000000, 0.000000, 0.329836, 0.926158, 1.540011, 1.577831, 0.939126, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.205676, 0.871643, 1.493929, 0.000000, 0.253020, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.644243, 0.000000, 0.000000, 0.000000, 0.375859, 1.727848, 0.422383, 0.174660, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.254460, 1.130512, 0.000000, 0.000000 },
        { 0.000000, 0.784477, 0.000000, 0.998946, 0.000000, 0.285039, 0.102523, 0.410657, 0.220223, 0.542668, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.080237, 0.189994, 0.320628, 0.000000, 0.475994, 0.000000, 0.000000, 0.288211, 1.597777, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.033134, 0.902215, 0.113690, 0.000000, 0.000000, 0.000000, 0.000000, 1.001955, 0.989820, 1.207893, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.228129, 0.000000, 0.416093, 0.000000, 0.227346, 0.000000, 0.338456, 1.391600, 0.493932, 0.156471, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.507494, 1.550875, 0.492583, 2.409824, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.695918, 1.042904, 0.000000, 1.194989, 1.515852, 0.000000, 1.229974, 1.293735, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.757977, 0.101872, 1.304161, 0.085419, 1.072893, 1.626752, 1.225391, 0.453414, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.113409, 1.195899, 0.871817, 1.061462, 1.192557, 0.134170, 0.443573, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.327862, 0.024505, 0.000000, 0.000000, 0.000000, 0.050349, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    }
}};

static constexpr dahl_fp expect_pool_forward[1][2][11][11] = {{
    {
        { 0.812104, 0.734616, 0.000000, 0.956951, 0.769605, 0.000000, 0.000000, 0.000000, 0.416501, 0.872151, 0.808694 },
        { 0.954936, 0.978046, 0.366463, 0.546050, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.673414, 0.989426, 0.766518, 0.237514, 0.308626, 0.000000, 0.287158, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.231980, 0.558727, 0.356449, 0.671973, 0.000000, 0.000000, 0.204305, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.334494, 0.241251, 0.856323, 0.587898, 0.231596, 0.031620, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.304786, 0.082538, 0.722334, 0.000000, 0.000000, 0.299114, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.030976, 0.000000, 0.000000, 0.103065, 0.000000, 0.364635, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.279604, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.006596, 0.070440, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 2.505369, 0.994411, 1.984232, 1.447631, 0.260187, 1.424735, 1.018132, 1.519731, 2.097321, 1.627757, 0.751707 },
    },
    {
        { 0.343168, 0.916219, 0.691122, 0.879745, 1.448550, 1.790658, 0.160657, 1.640169, 0.742491, 0.171919, 0.657301 },
        { 0.383044, 0.914177, 0.913372, 0.223506, 1.543851, 1.292712, 0.399180, 1.628806, 1.263085, 1.169013, 1.769546 },
        { 0.891721, 0.839815, 0.000000, 0.926158, 1.727848, 0.939126, 0.000000, 0.000000, 0.205676, 1.493929, 1.130512 },
        { 0.784477, 0.998946, 0.475994, 0.410657, 1.597777, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.902215, 0.416093, 0.227346, 1.391600, 1.207893, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.042904, 1.194989, 1.515852, 1.550875, 2.409824, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.195899, 1.304161, 1.626752, 1.225391, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.327862, 0.000000, 0.050349, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    }
}};

static constexpr dahl_fp expect_pool_mask[1][1][23][23] = {{
{
    { 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000 },
    { 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 1.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    },
    {
        { 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    }
}};

static constexpr dahl_fp expect_dense_forward[1][10] = {{
        0.000360, 0.000000, 0.000009, 0.000082, 0.980728, 0.000000, 0.000001, 0.000027, 0.000000, 0.018793
}};

static constexpr dahl_fp expect_dense_backward[1][2][11][11] = {{
    {
        { 0.001984, 0.014873, 0.114389, -0.045691, 0.049997, 0.030292, -0.059127, -0.105068, -0.137993, 0.033868, -0.009037 },
        { 0.032375, -0.034380, 0.118108, 0.118637, -0.081059, -0.026291, -0.114210, -0.046313, -0.098590, -0.071777, -0.036747 },
        { -0.111104, -0.072765, 0.045665, 0.043743, 0.015203, -0.116876, 0.154485, -0.023208, 0.064008, 0.034804, 0.156878 },
        { 0.092737, -0.056215, 0.044705, 0.048386, -0.152530, -0.041275, 0.000044, -0.045972, -0.092265, -0.126939, -0.015551 },
        { 0.051608, -0.064119, -0.107105, 0.087714, -0.034145, -0.047581, -0.175568, -0.044256, 0.157321, 0.096239, 0.050402 },
        { -0.034607, -0.028305, -0.004151, -0.109261, 0.142519, 0.039732, 0.178344, 0.040882, -0.037577, 0.030900, -0.160702 },
        { 0.057636, -0.032799, 0.107435, 0.158357, -0.076269, 0.093702, 0.160653, 0.068290, 0.054609, 0.036494, 0.011956 },
        { -0.027553, -0.090420, -0.016533, -0.110170, -0.071198, 0.135408, 0.075192, -0.109601, 0.124245, -0.003172, 0.092785 },
        { -0.137825, -0.039166, 0.002639, 0.013977, -0.100653, 0.091640, -0.060240, -0.139549, -0.184134, 0.184443, -0.007757 },
        { -0.071918, 0.002923, 0.008448, -0.119828, -0.020252, 0.025115, -0.057451, 0.096282, -0.061943, -0.028107, -0.001570 },
        { 0.113013, -0.133683, -0.028832, 0.028142, 0.087235, -0.006514, 0.049491, -0.096118, 0.074425, 0.183201, -0.069362 },
    },
    { 
        { -0.032335, -0.018694, -0.037625, 0.007639, 0.013518, -0.099213, 0.152141, 0.020055, 0.029461, -0.088494, 0.110704 },
        { -0.039206, -0.027994, -0.019172, 0.118902, 0.149979, 0.056002, -0.069112, 0.023308, 0.019297, -0.158231, -0.109572 },
        { -0.026570, -0.161630, -0.025771, -0.185311, 0.015619, -0.056984, -0.000560, -0.125556, -0.032040, -0.009794, 0.059546 },
        { -0.022403, 0.127421, -0.035337, 0.125438, 0.105599, -0.108287, -0.179942, -0.124986, 0.047600, 0.089585, -0.017768 },
        { -0.163173, 0.077120, -0.079586, 0.030842, 0.051058, 0.064068, -0.050573, 0.071863, 0.039673, -0.119215, -0.001660 },
        { 0.021178, 0.038120, 0.024918, -0.078869, -0.084870, -0.016580, -0.176945, -0.090085, -0.014540, -0.081873, -0.025453 },
        { -0.022323, 0.035674, 0.023512, 0.068765, 0.138179, 0.111975, 0.075513, 0.069793, -0.095489, -0.119828, -0.041634 },
        { 0.131682, -0.040379, -0.183440, -0.061061, -0.047169, 0.021861, -0.148474, 0.010229, 0.123191, 0.014628, -0.067728 },
        { 0.076612, 0.125587, -0.132908, -0.031317, -0.025649, -0.053705, -0.050243, -0.116311, 0.127171, -0.057750, -0.051126 },
        { 0.027324, -0.024976, -0.110678, -0.097336, 0.066439, 0.134979, -0.072729, -0.074836, -0.022385, -0.002140, 0.010884 },
        { 0.104199, -0.174781, 0.075856, 0.015909, -0.022304, 0.024720, -0.069594, 0.011202, -0.126146, -0.031751, 0.115340 },
    }
}};

static constexpr dahl_fp expect_dense_weights[2][10][121] = {
    {
        { -0.956334, 0.547856, -0.088720, -0.384954, -0.819335, -0.797883, 0.262437, 0.605732, 0.778889, 0.264017, -0.297581, -0.566751, 0.152211, -0.304275, 0.725459, -0.818905, -0.054136, 0.989636, -0.803226, 0.570628, -0.219620, -0.295440, 0.274402, 0.888396, 0.193788, -0.485153, 0.890333, -0.864671, -0.750989, -0.991278, 0.369688, 0.158241, 0.176945, 0.566679, 0.522464, 0.602731, -0.505819, -0.224142, -0.799343, -0.833515, -0.264958, 0.484503, 0.370570, 0.197838, -0.518118, 0.598007, 0.999297, -0.311630, -0.904126, 0.156415, -0.015616, 0.168675, 0.657318, -0.301655, 0.505358, -0.449795, 0.453837, -0.925608, -0.283470, 0.945966, -0.312560, -0.689393, 0.300222, 0.488101, -0.879331, 0.630938, -0.403662, 0.416380, 0.192430, -0.517641, -0.853204, -0.468103, -0.901733, -0.131449, -0.517153, 0.986791, -0.621389, 0.141570, 0.677206, -0.125958, -0.274188, 0.451484, 0.556508, 0.738830, -0.585898, -0.446726, -0.223908, 0.746143, 0.308538, 0.310843, 0.955007, -0.655402, 0.973818, -0.498006, -0.426644, -0.207561, 0.380860, 0.378682, -0.526909, -0.686307, -0.373984, -0.551909, 0.047862, -0.723532, 0.175644, 0.182090, 0.332009, -0.707046, 0.634465, 0.956850, -0.829020, 0.761939, 0.823453, 0.147240, 0.258135, 0.463170, 0.966581, 0.230009, -0.313137, -0.370847, 0.987918 },
        { 0.619427, 0.390426, 0.625754, -0.531524, 0.086000, 0.747016, 0.570414, 0.988564, 0.920839, 0.551207, 0.878819, 0.399092, 0.532234, -0.062375, -0.201002, -0.456012, 0.370222, -0.146902, -0.871329, -0.578581, 0.038965, -0.805270, -0.896070, 0.327037, -0.040533, -0.200921, -0.396034, -0.028184, -0.312239, 0.831346, 0.140854, 0.333669, 0.133797, 0.507052, -0.158997, -0.962455, -0.411230, 0.807341, 0.561560, -0.124210, 0.012623, 0.521446, 0.925144, 0.336925, -0.640189, 0.750623, -0.455629, 0.292119, 0.564863, -0.594552, -0.884804, -0.921822, 0.324733, 0.603334, 0.863541, -0.488386, -0.052674, -0.284820, 0.559462, -0.215200, -0.790016, -0.980694, 0.050115, 0.835071, 0.071984, 0.338838, 0.986630, -0.252821, -0.989823, 0.197657, 0.583698, -0.729528, 0.695875, 0.614189, -0.636094, -0.454988, 0.795212, -0.671755, 0.708495, 0.460305, -0.936448, 0.737267, 0.059803, 0.234443, 0.846242, 0.902990, -0.118142, 0.066311, -0.646868, 0.069354, -0.509889, 0.709071, -0.960024, 0.150428, 0.887651, 0.448999, 0.409877, -0.747178, 0.176353, -0.519306, 0.413720, -0.452534, 0.054816, -0.345879, -0.199345, -0.984645, -0.939574, 0.014334, -0.074541, -0.568117, -0.775495, 0.786291, 0.203381, -0.655052, -0.515090, 0.402328, -0.596655, 0.460672, -0.373707, 0.353154, -0.221783 },
        { 0.282285, 0.031514, -0.060955, 0.461381, 0.068246, -0.646188, 0.422247, -0.388007, 0.229303, -0.251657, -0.831907, -0.486493, -0.499782, -0.099130, 0.433253, 0.190734, -0.482270, -0.012157, -0.328302, 0.172296, 0.710414, 0.251086, -0.668054, -0.209959, -0.542190, 0.528987, 0.309928, -0.666677, -0.875681, 0.662645, -0.086720, 0.024472, 0.075626, 0.112215, -0.510167, -0.800477, -0.102995, -0.353242, 0.690655, 0.668405, -0.024818, 0.606942, 0.212873, -0.144455, -0.039426, 0.397488, -0.660479, 0.695136, -0.458589, -0.140034, 0.091862, -0.189338, 0.992073, -0.965906, -0.105781, 0.915573, -0.831704, -0.465344, 0.796134, 0.133131, -0.416899, -0.961706, -0.952580, 0.813483, -0.464192, 0.379926, 0.894028, 0.750911, 0.111844, 0.568828, -0.351128, -0.348224, 0.006916, -0.227409, 0.423367, -0.638609, 0.891159, 0.917644, -0.257156, 0.254908, 0.684644, -0.277403, -0.204097, -0.464772, -0.745131, 0.533566, -0.518001, -0.279092, 0.695358, -0.327966, -0.867041, 0.958991, -0.566890, 0.601939, -0.607762, -0.545394, 0.491680, 0.871078, -0.851111, -0.011718, 0.369450, 0.692502, -0.427074, 0.412369, -0.478094, -0.241156, 0.706910, 0.103334, -0.076782, -0.097846, 0.562120, -0.976949, 0.466037, 0.749579, -0.183876, 0.913390, 0.306581, 0.440778, -0.577485, -0.856086, 0.593481 },
        { -0.400714, -0.297389, 0.574191, 0.209321, -0.058714, -0.315277, 0.825243, -0.883689, -0.098463, -0.336119, -0.620892, 0.617744, -0.376354, 0.914816, -0.250809, -0.329681, -0.808689, -0.155570, -0.001240, 0.054917, -0.136333, -0.095616, 0.151508, 0.536397, 0.046870, -0.261823, -0.515215, -0.729431, -0.074798, -0.124007, 0.152544, 0.977129, 0.080758, 0.344112, 0.497589, 0.141952, -0.769223, -0.595499, 0.216873, -0.170702, 0.004412, -0.931506, 0.312093, 0.411196, -0.305184, -0.712498, -0.988891, 0.418961, -0.822325, 0.151647, -0.162102, -0.953837, -0.531167, 0.852056, -0.681232, -0.011784, 0.455282, 0.205271, -0.604227, 0.154266, -0.151670, -0.367139, -0.556390, 0.210209, 0.549173, -0.698629, 0.655454, -0.642601, 0.201801, 0.934661, -0.517415, 0.568678, 0.889734, 0.740073, -0.390417, -0.403372, -0.761102, -0.682647, 0.556611, -0.696206, -0.254713, 0.817059, 0.047300, 0.096788, 0.954317, -0.132135, 0.977893, 0.444430, 0.474762, 0.361588, -0.078841, -0.407265, 0.535470, 0.157433, 0.982769, -0.197864, -0.248473, 0.147648, -0.474584, -0.544874, -0.275885, 0.900634, -0.377821, 0.121405, -0.529565, -0.717762, -0.247953, -0.448348, 0.214939, -0.875503, 0.459420, -0.435189, -0.088293, 0.003666, 0.827273, -0.991778, -0.225550, -0.356936, -0.237475, 0.455953, 0.961334 },
        { -0.379427, 0.295139, 0.992709, 0.424882, 0.707614, 0.941581, -0.596889, -0.729415, -0.594790, -0.153374, -0.663811, -0.481618, -0.982813, 0.493325, 0.478771, -0.607686, -0.665743, -0.680686, -0.420108, -0.526664, -0.999256, 0.278074, -0.501419, 0.191849, 0.560417, 0.674226, -0.721958, -0.240803, 0.865328, 0.132433, 0.192381, -0.205078, 0.646546, 0.515438, -0.998765, 0.196403, 0.508189, -0.591426, 0.483713, -0.101469, -0.133925, -0.271910, -0.928183, 0.552832, 0.246998, -0.144286, -0.429582, 0.296260, -0.235081, 0.138428, -0.858958, -0.225251, 0.812959, 0.380045, 0.604804, 0.343065, -0.256773, 0.589558, -0.129184, 0.979470, 0.829729, 0.818841, 0.470754, 0.328508, 0.933703, -0.934669, 0.803825, 0.163104, 0.976597, 0.913455, 0.023660, 0.320131, 0.874486, 0.464580, -0.059162, 0.381491, -0.566622, -0.147089, -0.318317, 0.742075, -0.943042, 0.044682, 0.834877, 0.363146, -0.750936, 0.394664, -0.534616, -0.054624, -0.628026, -0.412771, 0.963253, 0.577547, -0.994595, 0.565880, -0.199930, -0.564933, -0.986071, 0.888828, 0.817402, -0.635998, 0.528575, -0.342933, -0.745457, -0.472326, 0.916416, 0.060672, 0.679327, -0.409890, 0.362704, -0.986835, 0.274183, -0.709976, 0.151653, 0.088176, 0.844627, 0.540136, 0.756942, -0.445122, 0.277328, 0.872893, -0.798714 },
        { 0.084388, 0.579767, -0.148277, -0.471420, 0.505104, 0.686880, 0.030427, 0.804133, 0.827047, -0.856975, 0.024513, -0.264224, -0.126301, -0.372146, -0.756211, 0.948723, -0.641529, -0.334877, 0.470961, 0.924919, 0.564186, -0.186270, -0.460061, -0.720315, -0.640438, -0.661277, -0.196199, -0.127134, 0.477338, -0.329676, 0.666454, -0.074148, -0.806890, -0.097789, -0.215323, -0.253915, 0.634507, 0.374121, 0.430587, 0.381676, 0.671727, -0.735976, 0.968455, -0.190426, 0.362390, -0.679343, -0.798502, -0.336826, 0.162516, 0.883242, 0.457324, 0.157348, 0.577342, 0.186399, 0.625906, -0.078954, 0.611028, -0.165558, -0.678041, 0.025277, 0.876087, -0.069274, 0.458110, 0.279980, -0.840716, -0.998466, -0.300378, 0.389871, -0.687283, -0.885649, 0.144345, -0.610821, -0.779535, 0.334857, 0.132364, 0.498006, 0.064754, 0.683039, 0.973380, 0.143491, 0.126240, -0.112136, -0.297770, -0.304338, -0.078278, -0.298242, -0.154591, 0.977996, 0.685442, -0.391701, -0.672987, 0.826257, 0.456986, -0.260605, 0.472314, -0.244462, -0.546052, 0.025172, -0.858606, 0.828875, 0.519497, 0.159506, 0.036180, 0.608213, 0.450354, -0.539429, -0.889620, 0.861081, -0.874981, -0.776972, -0.525781, -0.945850, -0.378031, -0.915655, -0.300531, -0.173520, -0.871647, -0.494115, -0.470527, 0.629449, -0.102243 },
        { -0.044222, -0.534563, -0.338469, -0.026989, 0.756840, -0.136875, -0.624603, 0.673711, 0.751543, -0.284788, -0.794269, 0.258090, 0.064261, 0.390712, -0.649499, 0.862588, -0.484819, -0.599024, -0.806695, -0.938729, 0.178784, 0.266224, -0.590510, -0.343645, -0.914176, 0.267117, -0.784867, 0.996828, 0.253824, 0.542838, -0.880496, 0.597043, 0.802576, -0.188603, -0.822081, 0.172806, -0.202936, -0.804252, 0.378964, -0.135499, -0.776329, 0.001585, 0.927822, 0.410324, 0.385954, 0.084968, -0.358587, 0.631766, -0.878079, 0.770434, 0.947701, 0.701026, 0.382270, 0.944083, -0.653174, 0.054374, -0.482198, -0.990699, 0.054373, 0.591667, 0.354184, 0.706778, 0.358647, 0.873935, 0.158912, 0.936887, 0.587609, 0.257250, 0.143190, 0.731113, -0.280915, -0.225868, -0.841447, -0.173134, -0.617590, -0.336147, -0.441436, 0.684545, -0.381469, -0.036809, 0.202849, -0.646994, 0.611609, 0.760337, -0.105576, 0.551164, -0.276937, -0.149604, -0.993599, 0.014203, -0.087539, 0.582963, 0.393276, -0.329058, 0.825988, -0.315125, -0.339563, -0.819296, -0.866362, 0.705972, 0.071083, 0.358430, 0.034168, 0.466404, -0.830773, 0.638956, -0.830957, 0.447287, -0.489426, -0.998977, 0.142212, 0.344252, 0.276222, 0.432948, -0.743180, 0.114523, -0.396055, -0.162282, -0.980987, -0.457991, 0.109293 },
        { 0.730072, 0.318865, -0.164483, -0.953704, 0.123706, 0.477563, 0.577691, -0.631505, 0.896368, 0.149558, 0.188947, 0.483844, 0.975837, -0.979916, -0.276590, -0.530774, 0.029459, -0.184021, 0.657930, -0.357403, -0.233640, -0.249593, 0.588750, 0.821970, 0.255783, 0.496010, -0.517142, -0.795960, -0.444684, 0.926806, 0.865085, -0.727937, 0.307218, -0.088486, 0.049682, -0.746785, -0.280854, -0.094653, 0.877476, -0.354722, -0.888152, -0.577989, -0.830586, 0.898272, 0.149825, 0.996544, -0.282657, 0.909453, -0.636438, 0.555024, -0.443827, -0.969442, 0.298187, 0.594284, -0.980718, -0.308922, 0.799739, -0.274163, -0.260860, 0.905594, -0.997513, -0.425594, 0.626620, 0.870045, 0.332985, 0.949179, 0.726879, -0.501493, -0.982715, 0.200729, 0.044784, -0.832303, 0.396562, 0.474848, 0.278901, -0.068107, 0.282581, 0.556583, -0.828747, -0.172259, -0.851699, -0.938545, -0.040058, -0.603643, -0.535815, -0.986207, 0.314024, 0.425122, -0.924976, -0.368008, 0.280412, 0.480290, 0.929815, 0.472194, 0.463502, -0.920295, -0.765892, 0.893778, 0.298877, 0.828724, 0.301794, 0.415292, -0.633440, -0.326403, 0.740385, -0.762293, 0.130526, 0.583790, 0.279456, 0.818903, 0.700439, -0.058160, -0.598038, 0.272281, 0.449359, 0.731608, -0.915936, -0.366970, -0.987314, -0.107793, -0.387785 },
        { -0.748496, 0.112668, -0.578651, 0.388271, -0.135083, 0.136752, 0.555041, 0.145181, -0.631705, 0.928327, 0.345693, 0.510212, 0.393640, -0.406037, -0.225225, -0.371518, -0.312132, 0.306007, 0.876310, 0.288338, -0.782987, 0.204637, 0.159879, -0.165350, -0.944359, -0.154897, -0.937941, 0.002716, -0.162635, -0.833013, -0.202575, 0.361581, -0.688717, -0.405490, 0.361865, -0.576421, -0.118917, 0.482880, 0.130877, 0.070381, -0.741907, 0.365288, -0.890387, 0.011429, 0.776757, 0.440883, -0.048973, 0.494038, -0.470051, 0.302717, 0.593356, 0.976767, -0.660197, -0.991070, 0.107877, -0.866309, 0.286730, 0.529633, 0.599600, -0.230139, 0.385504, -0.355688, 0.473486, 0.172166, 0.749254, 0.775451, 0.354022, 0.054884, -0.211865, -0.805292, -0.107406, -0.169527, -0.903196, 0.571252, 0.240222, -0.879152, 0.472414, 0.060202, 0.084565, 0.889435, -0.707251, 0.176430, 0.417105, -0.075491, -0.277269, 0.948713, -0.552383, -0.778810, 0.817400, -0.958375, 0.151454, 0.683347, 0.072367, -0.569767, -0.975917, 0.990752, 0.124089, 0.744441, -0.398497, -0.170165, 0.700716, 0.060440, -0.237119, -0.708679, 0.189313, -0.112141, 0.504581, 0.964635, -0.539037, 0.733880, -0.993605, 0.198123, -0.891814, -0.658889, -0.762497, 0.966076, 0.947932, 0.716312, -0.865766, 0.239570, -0.092045 },
        { -0.391861, 0.150803, -0.173573, 0.899576, 0.204967, 0.632085, 0.006181, 0.341878, 0.816253, -0.489844, -0.563620, -0.802116, -0.622308, -0.707092, -0.724966, 0.218387, -0.397560, 0.483970, 0.051823, 0.478586, -0.267338, 0.652328, 0.637874, 0.943442, 0.102340, 0.230230, -0.873252, 0.950066, -0.707023, 0.368548, -0.459890, -0.559567, -0.952521, -0.427445, -0.419648, -0.255608, 0.021138, 0.963245, 0.903890, -0.100188, 0.334544, 0.668636, 0.366120, 0.711183, -0.276017, 0.511813, 0.670867, -0.592113, 0.114870, 0.623685, 0.930750, 0.225850, -0.790571, -0.601002, 0.090929, 0.698425, 0.032852, 0.638328, 0.984268, -0.473120, 0.427166, -0.999474, 0.053946, 0.711550, 0.618053, 0.703803, 0.215966, 0.497394, -0.118749, -0.700998, 0.800589, -0.635150, -0.763494, -0.231604, -0.615901, 0.009688, -0.688474, 0.134115, 0.603634, 0.910100, 0.181098, 0.770489, -0.541768, -0.403096, 0.366280, -0.871983, -0.502021, -0.999907, 0.777067, -0.013277, 0.936235, 0.434566, 0.032127, -0.365757, 0.414042, 0.857448, 0.891132, -0.991193, 0.895821, 0.096995, 0.498382, -0.428971, 0.476111, -0.265886, 0.660734, 0.646145, -0.302160, 0.221333, 0.649240, -0.970049, -0.853399, 0.662795, 0.465169, -0.184409, -0.042122, 0.620346, 0.262479, 0.549641, -0.460916, -0.978786, -0.083611 },
    },
    { 
        { 0.728217, -0.713630, -0.723748, 0.538010, -0.426153, 0.521289, -0.160524, 0.733174, 0.327980, -0.640542, -0.318358, 0.983664, -0.631622, -0.668646, 0.586463, -0.251312, 0.145400, 0.264232, -0.327808, 0.562942, -0.205949, -0.838026, -0.060964, 0.718505, -0.347775, 0.330279, -0.257077, -0.526675, 0.768816, 0.507086, 0.951260, 0.669959, -0.723334, 0.965810, -0.736440, 0.805091, -0.612993, 0.308853, -0.214313, -0.062899, 0.386410, 0.228219, 0.707126, -0.532178, -0.950211, 0.831220, -0.797659, 0.998131, -0.435378, -0.572127, -0.492701, 0.114199, 0.020333, -0.779649, -0.450417, -0.796736, -0.235730, 0.480308, -0.779849, 0.418790, -0.051752, 0.631526, 0.751197, 0.370401, -0.593605, -0.358387, 0.319745, -0.192002, -0.895643, 0.574724, -0.814197, -0.182883, -0.396415, -0.992778, -0.675682, 0.906317, -0.661588, 0.576843, 0.167503, -0.599358, -0.889774, -0.847414, 0.430329, 0.549601, -0.011063, -0.672026, -0.495789, -0.875184, -0.518103, 0.068465, -0.279535, 0.921220, -0.512625, 0.353907, 0.445312, 0.441236, 0.911009, -0.544608, 0.328064, 0.667308, 0.218537, 0.164386, 0.194243, -0.606529, -0.907532, -0.906132, -0.649776, 0.128189, -0.325417, -0.842528, 0.435361, -0.105815, 0.572414, -0.687708, 0.744632, 0.239604, 0.694349, -0.677494, -0.443559, -0.600938, -0.959017 },
        { 0.538157, -0.334421, 0.771193, -0.148441, -0.430567, -0.897484, 0.930171, 0.186805, -0.370375, -0.972894, -0.894604, -0.013968, -0.555835, 0.856121, 0.808617, 0.663843, 0.423930, 0.013119, -0.658102, 0.808843, -0.745362, -0.625051, -0.176225, -0.293412, -0.743292, -0.156578, 0.933549, 0.209994, 0.628073, -0.646157, 0.881253, 0.783464, -0.308264, 0.500305, -0.958144, -0.055035, -0.015476, -0.379039, 0.491942, 0.738301, 0.938757, -0.873131, -0.065426, -0.361690, 0.149240, -0.130189, 0.317848, 0.335676, -0.710237, -0.592478, -0.145130, -0.371887, -0.327599, 0.352307, 0.423376, -0.054775, -0.985487, 0.234439, -0.011031, -0.744411, 0.603977, -0.190765, -0.788254, 0.547936, 0.362423, -0.166873, -0.787927, -0.668159, 0.289686, 0.935067, -0.111073, 0.075196, 0.917749, 0.147473, 0.905765, 0.089052, -0.766485, -0.431567, -0.806257, 0.053231, 0.119918, -0.676233, 0.758864, 0.023371, 0.364857, 0.761612, 0.948281, -0.572491, -0.146442, -0.794810, -0.611848, 0.561949, -0.163678, -0.933071, -0.973020, 0.138615, 0.206406, -0.000783, -0.159240, 0.013819, 0.982592, 0.000028, -0.612238, -0.796903, -0.292482, 0.810887, 0.475575, 0.282662, 0.366353, 0.609188, 0.202035, 0.432312, -0.562652, 0.373709, -0.457249, -0.245989, -0.162958, 0.370714, -0.818535, -0.533876, -0.759331 },
        { -0.015347, 0.717599, 0.874159, 0.513741, 0.423326, 0.231151, 0.124216, -0.288732, -0.515695, -0.885453, -0.185822, 0.007699, -0.823608, -0.724153, 0.937251, 0.702246, -0.718389, 0.250606, -0.503798, 0.075895, 0.480123, -0.782762, -0.100849, -0.102264, -0.817476, -0.378227, -0.036129, -0.559833, -0.212160, -0.217220, 0.767469, -0.102009, 0.339313, 0.078406, 0.116963, 0.770236, 0.461346, 0.201424, -0.624492, 0.178738, -0.291405, 0.445265, -0.942891, 0.187271, -0.289084, 0.304463, 0.323958, -0.542412, 0.759087, -0.506382, -0.775119, 0.473135, -0.829615, -0.798660, 0.978248, 0.896075, -0.534364, -0.597188, -0.346439, -0.632306, -0.188950, 0.692076, 0.343240, -0.176179, 0.855306, 0.978377, 0.959178, 0.866890, -0.126072, -0.242901, 0.642949, 0.373973, -0.480317, -0.654568, -0.755620, -0.462279, -0.223642, -0.457478, 0.388843, -0.669210, -0.316217, -0.874574, 0.099100, -0.064189, -0.407014, -0.329492, 0.446067, 0.227276, -0.674627, -0.753141, 0.168717, 0.374816, -0.369775, 0.959242, 0.465950, 0.002767, -0.276040, -0.057563, -0.618805, -0.600312, 0.428843, 0.075781, -0.633270, -0.801295, 0.184900, 0.738144, -0.769855, 0.745976, 0.945253, 0.898247, 0.333669, 0.193370, 0.778355, -0.984848, 0.372686, 0.422978, 0.514965, 0.676439, 0.801816, 0.456132, 0.032168 },
        { -0.340332, -0.307236, -0.941653, -0.791525, 0.663691, 0.740913, 0.734902, 0.107994, 0.916428, -0.304911, -0.282209, -0.838166, -0.968111, 0.436380, -0.626697, -0.618519, -0.270573, 0.053336, -0.178243, 0.052124, 0.970054, -0.698997, -0.312307, 0.424707, 0.287672, 0.568142, 0.549494, -0.528529, 0.046290, 0.941848, -0.433458, 0.640014, 0.486120, 0.916255, 0.538211, 0.506297, -0.761418, -0.213222, -0.012284, 0.302460, -0.367548, -0.869836, -0.276911, 0.434647, -0.363273, 0.996187, -0.936862, -0.500762, -0.329553, 0.087345, -0.385396, 0.376029, -0.798934, 0.220538, -0.227179, 0.111173, 0.393599, -0.511769, -0.379374, 0.993710, 0.322911, -0.539377, 0.626099, 0.682754, -0.457155, 0.823415, 0.363740, -0.989365, 0.788694, -0.973893, -0.732900, -0.610600, 0.066075, 0.797010, 0.068785, 0.188094, 0.780617, -0.651469, 0.767610, 0.362368, -0.104322, 0.067316, 0.385227, 0.630737, -0.266582, -0.189795, -0.689696, 0.125981, -0.922764, -0.201219, 0.713711, -0.383246, -0.116785, -0.901044, -0.368937, -0.109160, -0.449195, -0.941321, -0.233156, 0.008343, -0.176687, 0.499220, -0.998533, -0.622154, 0.548191, -0.912847, -0.212687, -0.756230, -0.330807, 0.213867, 0.920687, -0.173003, -0.499502, -0.204305, -0.686381, -0.232395, -0.410786, 0.729451, -0.356815, 0.330617, 0.174978 },
        { 0.165225, 0.535064, -0.720525, 0.576099, -0.577212, -0.262810, 0.870195, 0.849392, -0.489829, -0.288779, 0.403661, 0.448319, 0.103558, 0.483460, 0.710922, 0.674551, 0.044242, -0.804022, 0.084055, 0.692527, -0.889310, -0.413939, -0.710653, -0.833965, -0.806513, -0.915592, 0.808032, 0.345126, -0.168259, -0.363203, -0.501595, -0.766529, 0.261459, 0.315038, 0.938847, -0.023530, 0.968341, 0.574048, -0.689156, -0.869103, -0.529513, 0.709065, 0.141401, 0.270562, -0.900891, 0.187898, -0.680205, 0.941397, 0.504487, -0.305138, -0.284712, 0.281478, 0.752793, -0.931702, -0.275091, 0.932503, 0.575099, -0.158054, -0.713083, 0.020204, 0.054949, -0.998998, -0.171101, 0.680131, -0.214326, -0.135667, -0.317467, 0.747710, -0.288483, 0.500335, 0.486612, 0.360202, -0.090643, 0.789931, -0.932006, -0.398066, 0.043912, 0.714482, -0.344284, -0.896772, -0.386394, 0.057648, -0.449337, -0.762393, -0.497559, 0.285441, -0.712698, -0.051742, -0.156465, 0.599461, -0.663626, -0.075426, -0.394591, -0.922552, -0.197544, -0.297485, 0.851269, 0.281935, -0.166885, -0.030449, 0.313065, -0.648615, -0.961532, 0.829103, 0.542031, 0.206468, -0.426091, -0.913196, -0.078313, -0.559557, 0.654826, -0.859794, -0.212174, -0.806701, 0.186057, -0.043502, -0.153040, 0.524884, -0.392474, 0.232569, 0.782551 },
        { 0.140162, 0.720930, 0.029325, -0.889105, -0.075100, 0.445923, -0.050026, -0.076623, 0.037156, 0.693877, 0.761801, -0.772776, -0.961489, -0.640672, 0.099754, 0.633094, -0.631865, -0.293273, -0.153267, -0.250072, -0.726310, 0.163261, 0.354093, 0.633062, -0.502564, 0.471907, -0.173856, 0.551051, -0.409932, -0.329402, 0.614946, -0.749602, -0.316520, 0.908001, 0.225254, 0.698153, 0.854068, -0.727899, 0.101298, -0.599409, -0.687901, -0.868227, -0.315999, 0.997102, -0.611001, -0.235618, -0.288999, 0.472758, 0.028095, 0.075306, 0.538832, -0.204912, -0.634874, -0.601060, -0.293772, -0.340034, 0.271786, 0.843430, 0.627539, -0.313716, -0.167035, 0.464487, 0.534553, 0.061554, -0.318004, 0.815997, -0.910319, -0.249735, -0.953721, 0.281364, -0.051265, 0.229166, 0.829659, 0.910836, 0.913128, 0.695739, -0.773885, -0.536197, -0.097471, -0.871086, 0.734611, -0.272310, 0.707993, 0.190122, 0.372841, -0.909207, 0.092885, 0.747157, -0.210969, -0.379743, 0.882545, 0.204260, -0.235709, -0.964868, -0.338209, 0.748655, -0.523038, -0.717749, 0.543011, -0.892745, 0.379358, -0.339959, 0.940324, -0.394787, 0.745109, 0.275390, 0.850013, -0.284084, 0.220107, -0.418902, 0.084906, -0.631135, -0.188523, -0.838975, 0.256756, -0.647386, 0.533671, -0.108357, 0.074460, -0.625288, -0.277676 },
        { -0.447223, 0.380328, 0.213411, 0.980259, 0.158751, -0.799871, 0.673109, 0.138771, 0.719927, -0.243805, -0.031641, 0.354657, -0.251471, -0.643143, -0.248687, 0.777438, 0.048508, -0.427217, -0.758202, 0.894233, -0.472640, -0.706840, 0.682497, 0.657834, 0.241137, -0.769736, -0.679115, 0.412777, -0.553511, -0.807346, 0.976739, -0.498108, 0.742551, 0.287167, 0.332801, -0.417706, -0.875503, 0.951191, 0.970156, -0.960423, 0.510664, 0.484072, 0.854553, -0.120364, 0.952769, -0.210262, -0.512494, 0.954756, -0.633696, 0.755798, -0.423323, 0.771939, -0.298049, -0.856826, -0.332155, -0.479499, 0.547409, 0.032597, -0.860419, -0.810027, 0.080672, -0.742697, 0.728659, 0.848211, 0.939376, 0.328853, 0.777512, -0.661525, 0.823921, 0.343767, -0.335601, 0.998896, -0.786838, -0.284972, 0.184455, -0.460445, 0.115288, -0.858292, 0.900595, 0.206303, 0.310512, 0.202669, -0.635947, -0.163586, 0.382545, 0.615945, -0.330620, -0.601156, 0.646333, 0.764715, 0.981127, -0.095914, 0.428302, -0.940362, -0.660710, -0.168868, -0.681820, -0.059246, 0.235731, -0.777635, -0.730186, 0.336422, -0.008420, -0.178263, 0.823706, 0.485541, 0.168138, -0.901248, 0.535662, 0.925337, -0.988275, 0.167594, 0.465742, 0.987862, -0.449673, -0.319750, -0.159076, -0.240664, -0.593751, 0.822248, 0.361905 },
        { -0.222290, 0.889244, 0.126482, 0.965148, -0.621278, 0.146024, 0.623519, -0.015713, -0.313240, 0.376877, -0.645244, 0.289162, 0.703448, -0.304835, -0.300370, -0.833485, -0.196783, 0.646198, 0.147635, 0.375085, 0.564769, -0.557786, 0.132875, 0.799669, -0.038885, 0.079104, -0.712499, -0.570037, 0.251180, 0.941643, 0.541613, -0.074209, -0.497857, -0.061661, 0.331753, 0.414406, -0.957855, 0.084811, 0.545691, 0.536845, -0.061025, 0.268705, 0.984216, -0.189471, 0.713615, -0.786945, 0.906242, -0.993624, -0.581561, -0.049592, -0.492031, -0.809837, 0.436190, 0.540616, 0.779128, 0.566457, 0.693410, 0.613677, 0.673904, -0.913022, 0.934262, 0.642747, -0.561121, 0.244603, 0.691656, -0.055996, -0.758193, 0.633573, -0.760482, -0.176263, 0.251651, -0.379763, -0.577882, -0.622687, -0.796589, -0.639306, -0.235675, 0.571355, -0.918424, -0.939478, 0.110153, 0.793767, -0.861307, 0.062728, -0.601531, -0.161398, -0.981711, -0.798243, 0.534603, -0.811380, 0.956639, -0.062043, -0.732738, 0.989110, 0.449356, 0.261243, 0.924061, 0.427855, 0.482351, 0.407157, 0.729575, 0.937064, -0.109716, 0.270879, 0.156237, -0.975511, 0.532944, -0.305190, 0.670952, -0.916845, -0.222888, -0.679818, -0.233098, -0.932317, -0.598256, 0.799331, 0.908028, -0.039116, 0.471701, -0.662064, -0.392254 },
        { 0.740814, -0.675128, -0.190881, -0.340304, 0.466388, -0.285814, 0.710141, -0.253878, -0.234361, -0.981932, -0.179965, 0.770087, -0.907705, 0.529077, -0.869726, -0.207343, -0.846529, -0.656543, 0.228550, 0.145135, -0.560039, 0.841142, -0.949861, -0.912637, -0.947155, 0.217914, -0.784529, -0.346201, -0.229790, -0.262002, -0.796609, 0.710056, -0.351815, -0.680548, 0.363447, 0.275301, -0.256633, -0.193665, -0.211464, 0.390715, -0.000871, 0.285738, 0.596630, 0.477633, -0.507218, -0.925937, -0.208980, -0.946966, -0.002593, -0.141159, 0.453197, -0.289525, -0.532904, 0.916323, -0.589493, 0.902987, 0.915668, -0.375763, -0.820665, 0.338718, 0.593032, 0.631710, 0.900648, 0.362806, -0.206189, 0.269281, 0.920425, -0.369217, -0.041997, -0.197698, -0.592579, -0.221853, -0.289410, 0.020545, 0.451012, -0.437957, 0.623918, 0.846056, 0.648343, -0.427807, 0.712827, 0.513919, -0.255894, 0.086582, 0.168677, 0.929380, 0.384964, 0.269502, 0.748849, 0.784448, -0.649310, -0.243906, 0.292073, 0.797795, 0.298824, 0.794948, -0.922690, 0.644903, -0.192004, -0.476476, -0.015765, 0.121936, 0.557089, -0.075102, -0.681485, -0.505800, -0.081956, 0.604024, 0.839667, 0.314445, -0.627421, -0.150141, 0.418260, -0.728696, -0.526529, 0.970945, 0.611028, 0.943022, 0.484319, 0.474055, -0.877674 },
        { 0.498284, 0.734055, -0.330268, 0.506759, -0.700610, 0.766281, -0.679186, 0.660948, -0.782378, 0.614685, -0.718499, 0.851725, 0.397471, 0.687351, -0.498873, -0.839321, -0.513832, -0.095235, -0.137690, 0.508132, 0.735235, 0.719936, -0.430812, 0.822264, -0.543587, 0.982716, 0.665332, 0.934665, -0.162183, 0.916882, -0.172462, -0.651392, -0.334686, 0.551326, -0.350649, 0.341647, -0.306828, -0.486685, 0.414723, 0.965237, 0.744654, 0.223621, -0.771427, 0.451350, 0.771031, -0.593720, 0.133125, 0.640549, -0.004471, -0.958157, 0.230611, -0.450997, 0.348035, 0.283483, -0.258189, 0.726184, 0.197992, -0.396915, 0.105974, 0.908989, 0.223934, 0.805047, 0.747411, 0.828187, 0.619968, 0.123755, -0.077944, 0.396431, -0.512292, -0.188592, -0.922237, -0.781305, -0.860358, 0.077923, 0.041358, 0.823695, 0.468018, -0.614722, 0.067512, 0.973484, 0.235767, 0.538059, -0.671744, 0.751425, -0.601609, -0.970479, -0.861699, 0.638212, -0.937441, -0.680781, 0.691225, 0.244092, -0.133218, -0.374671, 0.314752, 0.888210, -0.444899, 0.870098, 0.354362, -0.308661, 0.567551, 0.479817, 0.030924, 0.151307, -0.834165, 0.947164, 0.336565, -0.684632, -0.056584, -0.670513, -0.407210, 0.921856, -0.984993, -0.968753, 0.413476, -0.295325, 0.556554, 0.410278, 0.893172, 0.555844, -0.393674 }
    }
};

static constexpr dahl_fp expect_dense_biases[10] = {
    0.252725, 0.694263, -0.200022, 0.996660, -0.127086, -0.429259, -0.255980, 0.835992, -0.753606, 0.507053
};

static constexpr dahl_fp expect_pool_backward[1][1][23][23] = {{
    {
        { 0.001984, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.045691, 0.049997, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.137993, 0.033868, 0.000000, -0.009037, -0.000000, 0.000000 },
        { 0.001984, 0.000000, 0.014873, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.032375, 0.000000, -0.000000, -0.000000, 0.118108, 0.000000, 0.000000, 0.118637, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.034380, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.000000, 0.045665, 0.000000, 0.000000, 0.043743, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.111104, -0.000000, -0.000000, -0.072765, 0.000000, 0.000000, 0.000000, 0.000000, 0.015203, 0.000000, -0.000000, -0.000000, 0.154485, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.092737, -0.000000, -0.000000, 0.044705, 0.000000, 0.048386, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000044, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.056215, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.064119, -0.000000, -0.000000, -0.000000, 0.087714, 0.000000, -0.034145, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.051608, -0.000000, -0.000000, -0.107105, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.047581, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.034607, -0.000000, -0.000000, -0.028305, -0.004151, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.039732, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.110170, -0.000000, -0.000000, -0.000000, 0.000000, 0.135408, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.000000, -0.027553, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.091640, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.020252, 0.025115, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.113013, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.133683, -0.028832, -0.000000, 0.028142, 0.000000, 0.087235, 0.000000, -0.006514, -0.000000, 0.000000, 0.049491, -0.096118, -0.000000, 0.074425, 0.000000, 0.183201, 0.000000, -0.069362, -0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    },
    {
        { -0.032335, -0.000000, -0.018694, -0.000000, -0.000000, -0.000000, 0.007639, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.152141, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.037625, 0.000000, 0.000000, 0.000000, 0.013518, -0.099213, -0.000000, 0.000000, 0.000000, 0.000000, 0.020055, 0.029461, 0.000000, -0.000000, -0.088494, 0.000000, 0.110704, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.027994, -0.000000, -0.019172, 0.000000, 0.000000, 0.000000, 0.000000, 0.056002, 0.000000, -0.069112, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.039206, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.118902, 0.000000, 0.000000, 0.149979, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.023308, 0.000000, 0.019297, -0.000000, -0.158231, -0.109572, -0.000000, 0.000000 },
        { -0.000000, -0.026570, -0.161630, -0.000000, -0.000000, -0.000000, -0.000000, -0.185311, 0.000000, 0.000000, -0.056984, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.032040, -0.000000, -0.009794, 0.000000, 0.000000, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.015619, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.059546, 0.000000, 0.000000 },
        { -0.000000, -0.022403, 0.000000, 0.127421, -0.000000, -0.000000, 0.000000, 0.125438, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.000000, 0.000000, 0.000000, -0.035337, -0.000000, 0.000000, 0.000000, 0.105599, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.163173, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.051058, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.000000, 0.077120, 0.000000, -0.079586, -0.000000, 0.000000, 0.030842, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.078869, -0.000000, -0.084870, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.021178, 0.000000, 0.038120, 0.024918, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.000000, 0.035674, 0.000000, 0.000000, 0.023512, 0.068765, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.022323, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.131682, 0.000000, -0.000000, -0.000000, -0.000000, -0.183440, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 }
    }
}};

static constexpr dahl_fp expect_conv_backward[1][1][28][28] = {{{
    { -0.027476, -0.008650, 0.005229, -0.016204, 0.028388, -0.011851, 0.014708, 0.044351, -0.019673, -0.015726, -0.034235, -0.019412, 0.141718, 0.046164, -0.098005, 0.058704, -0.070685, 0.162022, 0.072444, 0.033808, -0.032811, -0.078369, -0.008424, 0.006794, -0.006024, -0.002287, 0.000000, 0.000000 },
    { -0.014763, -0.025516, -0.012432, -0.025693, -0.020039, 0.002906, -0.006703, 0.045664, -0.019218, 0.052342, -0.059146, -0.033628, 0.109677, 0.042047, -0.005864, -0.004421, 0.120458, -0.162039, -0.030698, -0.013769, 0.062510, 0.248813, 0.038996, -0.042153, 0.036981, -0.046402, 0.017597, 0.000000 },
    { -0.052530, -0.004685, -0.002971, 0.017907, -0.100107, -0.128269, -0.105697, -0.113188, -0.018080, -0.026242, 0.065910, 0.013129, 0.142170, -0.116943, -0.158228, -0.016682, 0.079279, 0.072335, -0.045620, -0.042984, -0.112391, -0.014129, 0.223922, -0.126603, 0.073361, 0.075565, -0.101682, 0.000000 },
    { -0.007027, -0.000051, 0.076103, 0.009366, -0.024092, -0.005766, 0.024498, -0.046758, -0.078217, -0.042600, -0.161266, -0.097320, -0.081567, -0.049765, 0.053451, -0.225614, 0.107994, 0.003251, 0.109369, -0.370479, -0.085862, 0.173014, -0.058679, -0.042522, -0.136468, -0.007715, 0.106519, 0.000000 },
    { 0.014790, -0.019262, -0.083369, -0.004681, 0.146312, 0.019647, 0.188434, -0.010590, 0.043617, 0.084905, 0.198749, -0.006888, -0.264973, 0.072268, -0.279325, -0.017543, 0.073445, -0.030652, -0.026291, 0.115660, -0.121273, 0.033108, 0.030115, -0.180092, 0.028640, 0.199295, -0.033370, 0.000000 },
    { 0.062548, 0.082773, -0.023282, 0.003981, 0.039430, -0.112816, 0.105701, 0.058448, -0.296041, 0.121077, -0.056974, -0.091412, 0.207212, -0.117463, 0.148776, -0.000351, -0.087777, 0.078762, -0.122605, -0.209781, 0.231823, 0.168571, 0.248186, -0.085811, -0.368956, -0.030915, 0.102519, 0.000000 },
    { 0.025870, -0.134514, -0.151636, 0.319044, 0.240155, 0.188759, -0.099003, -0.223779, 0.168429, -0.179718, 0.098486, -0.160686, -0.321798, 0.182708, 0.039883, -0.039541, -0.177489, -0.190057, 0.011346, 0.059281, 0.135102, 0.113801, 0.053067, 0.050925, -0.028194, -0.088418, -0.025879, 0.000000 },
    { -0.073777, -0.000640, 0.116361, 0.032812, -0.054369, -0.038491, -0.056993, 0.001432, 0.061961, -0.078224, 0.052569, -0.040402, -0.154213, 0.225261, 0.050535, 0.065035, 0.107081, -0.128669, -0.028353, 0.064662, 0.206139, 0.150706, 0.226732, -0.039252, -0.197095, -0.044175, 0.000000, 0.000000 },
    { -0.008423, 0.044325, 0.063237, 0.344189, 0.116347, 0.065174, -0.389414, -0.073785, 0.236158, 0.258162, 0.016958, -0.094628, 0.036485, -0.314884, 0.069284, 0.050345, 0.086022, 0.120978, 0.005422, -0.060318, 0.003988, -0.065861, -0.063404, 0.070267, 0.147714, 0.007666, 0.000000, 0.000000 },
    { -0.057625, -0.154022, -0.190023, 0.100981, -0.016446, 0.149260, 0.477100, -0.005947, 0.168239, -0.267197, -0.178869, 0.199527, 0.121863, 0.235421, -0.136761, -0.103476, -0.129529, 0.003221, 0.015345, -0.023483, -0.009275, -0.023130, -0.040841, -0.046645, 0.035675, 0.055143, 0.000000, 0.000000 },
    { 0.119605, -0.022863, 0.053318, 0.142979, -0.078493, -0.414737, -0.259059, 0.052781, -0.086441, -0.014423, -0.087709, -0.195668, 0.025422, 0.011457, 0.245375, 0.015253, 0.091734, -0.051008, 0.000006, 0.000000, 0.033034, -0.028474, 0.033545, -0.013243, -0.035905, -0.013920, 0.000000, 0.000000 },
    { -0.003979, 0.053918, 0.130386, 0.207827, -0.131116, -0.013440, -0.005584, 0.007033, -0.093325, -0.058379, -0.110154, -0.106914, -0.083844, 0.161466, -0.068608, -0.046691, 0.042272, 0.000019, -0.000015, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { -0.019586, 0.046635, 0.008201, 0.187663, 0.230231, 0.074483, -0.088149, 0.008083, -0.162449, -0.059950, 0.005363, 0.002698, -0.048213, -0.107980, 0.040058, -0.065230, -0.026418, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.004151, -0.033836, 0.079279, -0.144354, -0.175165, -0.024808, 0.210695, 0.202825, 0.181729, -0.005408, -0.083485, -0.014024, -0.051243, 0.064620, 0.039266, 0.058254, -0.006458, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.085873, -0.039676, -0.010842, 0.022956, -0.034043, -0.080606, -0.066779, 0.312873, 0.010210, 0.207829, -0.029316, -0.068595, -0.189794, -0.200347, 0.008309, 0.075557, 0.049969, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.079467, 0.103344, -0.076688, 0.017495, 0.019215, -0.305525, -0.266432, 0.048508, -0.021243, 0.025166, 0.294359, 0.094482, 0.108404, -0.037415, -0.086615, -0.137960, -0.075389, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.087731, -0.056058, -0.114319, -0.060092, 0.015678, -0.033264, 0.049978, 0.024164, -0.010214, -0.116122, -0.173157, 0.238218, 0.052716, 0.031337, 0.047198, 0.070031, -0.120329, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { -0.078503, -0.024993, -0.002145, -0.101853, 0.148999, 0.048009, 0.046526, 0.113285, 0.077730, -0.259282, -0.060949, -0.185024, -0.201299, 0.072561, 0.097063, 0.146244, 0.098375, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { -0.046627, -0.090753, -0.074423, -0.151645, 0.062711, 0.183032, 0.046556, 0.131490, 0.243775, -0.042149, -0.086074, 0.065814, 0.045142, -0.132668, -0.144583, -0.187496, -0.032642, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.073052, -0.077258, 0.068153, -0.008808, -0.064222, -0.111589, 0.168299, -0.106087, -0.054347, 0.158398, -0.013153, -0.025974, 0.024168, 0.129588, 0.009690, 0.110959, -0.126115, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, -0.091798, -0.087722, -0.072845, 0.029118, 0.063697, 0.037693, 0.000000, 0.000000, -0.002329, -0.000539, 0.000335, -0.081781, 0.075519, 0.041610, 0.043647, 0.050881, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.012995, 0.019125, 0.094042, 0.045454, -0.023976, -0.104808, -0.116460, -0.152404, -0.080407, -0.006265, 0.081916, 0.079789, -0.098472, 0.034049, -0.041131, -0.010453, -0.043229, -0.266847, -0.150779, 0.039386, 0.108284, 0.152231, 0.032724, -0.046238, -0.017554, 0.000000, 0.000000 },
    { 0.000000, 0.063961, 0.043997, 0.010783, 0.013453, 0.100284, 0.014967, 0.150039, 0.101209, 0.011754, -0.040641, -0.194572, -0.066859, 0.043163, -0.015043, 0.022728, -0.025885, 0.040361, 0.056128, 0.027684, -0.140616, -0.193072, -0.144679, -0.049031, 0.063954, 0.038617, 0.000000, 0.000000 },
    { 0.000000, -0.013555, -0.109103, 0.018096, -0.002395, 0.028908, 0.025407, -0.068233, 0.159769, 0.058888, 0.039650, 0.023412, 0.036100, -0.050213, -0.060354, -0.016769, 0.037128, 0.021068, 0.027218, 0.182679, 0.041633, -0.029284, 0.078697, -0.186977, -0.035873, 0.061638, 0.000000, 0.000000 },
    { 0.000000, 0.058615, 0.024733, -0.067965, 0.070251, -0.169034, -0.089988, -0.128068, -0.079474, -0.068298, 0.071122, 0.055970, 0.076211, 0.023859, -0.023053, 0.121946, -0.059778, -0.096832, 0.006802, -0.186787, 0.207107, 0.215223, 0.057668, 0.061231, -0.043620, -0.038512, 0.000000, 0.000000 },
    { 0.000000, -0.086498, 0.002817, 0.028265, -0.072478, 0.140799, 0.072389, 0.123733, 0.028115, -0.000327, -0.089625, -0.045669, -0.061516, 0.041098, -0.034066, -0.058705, 0.082775, 0.031598, 0.119532, -0.013957, -0.228756, -0.106014, -0.087801, 0.063081, 0.052762, -0.009414, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.102318, 0.018736, -0.116170, -0.013001, -0.048566, -0.010534, 0.004649, 0.092213, -0.031268, 0.031230, -0.065035, 0.072048, 0.042495, -0.152352, 0.046806, -0.132882, 0.017666, 0.242748, -0.072110, 0.017497, -0.043100, -0.029305, 0.022887, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
}}};

static constexpr dahl_fp expect_conv_filters[1][6][6] = {
    {
        { -0.342137, 0.404480, -0.268363, 0.839465, 0.003042, -0.784705 },
        { 0.118033, -0.779361, -0.570128, -0.766269, 0.197760, 0.503338 },
        { 0.541161, 0.612104, 0.565029, 0.814818, -0.980373, -0.134240 },
        { -0.901661, 0.499561, 0.332669, 0.211600, 0.371909, 0.548674 },
        { -0.560420, -0.931288, -0.772249, -0.360249, 0.153907, 0.102073 },
        { 0.251158, 0.661090, 0.189343, -0.439370, -0.776351, -1.004021 },
    }
};

static constexpr dahl_fp expect_conv_biases[1][23][23] = {
    {
        { 0.464771, 0.436084, 0.713466, -0.531242, -0.616788, -0.170705, -0.105415, 0.979166, 0.781708, 0.349176, 0.971809, -0.233529, 0.874534, -0.705710, -0.654847, -0.959932, 0.964755, 0.183415, 0.496641, 0.310189, 0.849496, -0.761242, 0.007242 },
        { 0.812005, 0.117336, 0.733873, -0.975060, -0.446804, -0.845850, -0.944386, 0.646653, -0.620415, 0.300335, -0.289630, -0.504688, -0.913791, 0.080713, 0.308192, 0.413157, -0.879404, 0.281577, -0.619637, 0.582166, -0.106230, -0.218954, 0.928713 },
        { 0.953317, -0.477015, -0.346058, 0.053940, 0.360558, -0.204479, -0.642764, 0.529199, -0.632968, -0.586414, 0.028556, 0.171181, 0.272491, 0.038738, -0.328028, -0.357052, -0.516578, 0.538235, 0.600712, 0.713384, 0.559906, 0.414351, 0.430534 },
        { 0.258591, -0.364017, 0.979765, 0.051055, 0.003294, -0.426639, -0.814991, -0.009483, 0.037632, 0.006110, 0.388698, 0.168041, 0.573996, -0.019944, -0.930617, -0.937829, 0.513980, 0.034213, 0.694418, 0.641254, 0.408815, -0.739744, 0.822560 },
        { -0.395849, 0.275288, -0.436058, 0.008780, 0.763784, -0.332046, -0.571123, 0.234303, -0.451872, 0.810797, 0.242496, -0.571354, 0.202927, 0.951643, -0.203975, 0.691898, -0.634395, 0.001783, 0.631171, 0.674553, 0.593339, 0.183250, -0.269263 },
        { 0.678969, -0.170210, 0.207221, 0.993064, -0.296457, -0.758744, 0.135024, -0.022303, 0.561782, -0.794107, 0.727152, -0.574888, 0.814792, -0.408305, 0.332688, -0.425506, -0.398703, 0.490313, 0.008423, 0.384498, 0.672091, 0.552979, -0.105961 },
        { -0.634037, 0.227344, 0.232828, -0.853422, 0.358602, -0.975942, 0.679286, 0.446710, -0.314732, 0.702928, 0.451336, -0.284783, -0.016230, 0.979075, -0.763989, -0.144491, -0.753541, 0.826170, -0.335604, -0.794085, -0.355531, 0.465583, -0.078657 },
        { -0.144448, -0.757705, -0.198432, 0.561537, 0.044876, -0.440089, -0.144166, 0.108990, -0.602105, -0.665128, -0.848900, -0.107868, -0.697172, -0.413011, 0.500636, 0.075047, -0.885057, -0.492460, 0.041794, 0.566704, 0.626143, 0.110623, 0.210871 },
        { -0.058965, 0.082144, 0.244457, -0.724825, 0.574029, 0.812518, 0.580367, 0.478708, 0.959945, 0.492553, 0.447254, 0.501884, 0.621016, 0.020751, 0.898336, 0.951252, -0.044598, 0.681395, -0.964440, 0.634968, 0.828218, 0.525509, 0.760640 },
        { -0.072771, 0.365401, -0.169576, -0.099670, 0.834548, 0.799487, 0.452325, 0.081566, -0.655125, 0.436974, 0.412013, 0.745119, -0.939883, -0.494468, -0.983929, -0.469609, -0.973986, -0.622024, 0.652826, 0.815021, 0.442379, 0.331963, -0.312331 },
        { 0.300012, -0.539692, -0.303976, 0.138084, 0.998894, -0.617674, 0.541943, 0.748262, 0.658303, -0.849143, 0.863822, 0.002020, 0.983988, -0.295338, -0.339104, -0.729480, 0.575126, 0.372640, -0.220877, 0.925818, -0.585861, 0.712717, 0.145095 },
        { 0.139356, -0.183226, 0.083725, -0.490468, -0.729865, -0.530144, 0.790408, -0.632873, -0.506633, 0.789060, 0.087100, -0.388582, 0.229500, 0.556410, -0.102247, 0.403195, 0.504903, 0.230101, -0.635455, 0.674372, 0.195026, 0.390523, -0.073763 },
        { 0.505322, 0.231394, 0.459668, -0.304319, -0.331413, -0.822693, -0.476036, 0.589327, 0.166542, 0.465652, 0.682857, -0.117213, -0.466427, 0.561744, -0.297672, 0.880346, 0.215903, -0.097376, -0.430235, 0.523821, -0.935514, 0.649470, 0.271453 },
        { -0.290782, 0.333028, 0.834639, 0.857541, -0.373114, 0.264090, -0.180919, 0.570365, -0.364757, 0.173006, -0.461839, -0.863828, 0.364889, 0.332174, 0.210893, 0.253157, -0.041623, -0.258108, -0.602069, 0.828114, -0.439618, 0.910040, 0.653967 },
        { -0.681802, 0.266674, -0.480856, 0.458049, -0.714173, 0.144026, 0.842806, -0.649975, 0.856593, -0.676638, -0.567860, 0.223580, -0.253890, 0.488178, -0.290506, 0.644336, 0.160868, 0.827116, -0.639522, -0.986407, 0.108103, -0.400042, 0.485352 },
        { 0.035854, 0.742993, -0.456645, -0.991199, -0.705450, -0.356964, 0.409019, 0.335771, -0.619778, -0.964364, -0.138362, 0.732059, 0.957581, -0.255203, -0.785563, -0.407640, -0.082499, 0.533909, -0.458732, 0.226140, 0.770196, 0.357809, 0.230575 },
        { -0.232570, -0.190219, -0.297247, 0.800819, -0.453351, -0.869469, -0.116023, -0.449109, -0.476448, 0.672920, 0.070752, 0.535464, 0.295833, 0.879997, -0.484876, -0.347222, 0.960924, 0.914379, -0.866023, -0.287477, 0.473598, -0.027929, 0.811978 },
        { -0.113285, -0.008646, 0.298783, 0.917856, -0.376290, 0.139908, 0.867332, 0.366858, -0.342229, 0.751996, 0.585952, 0.967224, 0.937393, 0.030376, 0.035026, -0.442359, -0.130779, 0.934515, -0.530403, 0.263810, -0.066061, -0.162980, -0.028501 },
        { 0.147948, -0.857619, 0.627339, 0.517963, 0.317000, 0.044549, -0.420677, 0.189729, -0.227886, 0.314041, -0.750071, -0.014772, 0.751137, -0.417598, -0.014227, 0.443954, -0.816830, -0.062119, -0.745143, 0.043313, -0.035438, -0.409518, 0.167438 },
        { -0.319151, -0.919756, 0.557724, -0.477637, -0.683707, -0.653330, 0.142891, -0.547403, 0.829733, 0.889430, 0.807146, 0.471935, -0.695703, 0.939578, 0.963487, -0.704469, -0.502339, 0.915831, 0.294051, 0.632559, 0.622242, 0.079062, 0.953447 },
        { 0.351978, 0.985048, -0.675032, 0.873955, -0.650815, -0.654340, 0.674879, 0.697409, -0.900465, -0.003573, 0.259810, 0.209764, -0.275382, 0.178259, 0.597139, -0.980910, -0.914885, -0.189511, 0.770709, 0.736885, -0.633124, 0.011918, -0.009051 },
        { 0.687351, -0.909074, -0.725813, -0.981864, 0.062695, -0.767583, 0.616967, -0.371218, -0.318201, -0.570893, 0.876347, 0.566816, -0.763126, -0.006605, 0.512749, -0.484370, 0.918976, 0.886218, 0.553168, 0.584087, 0.142165, -0.863094, 0.716393 },
        { 0.356355, 0.520415, -0.533583, -0.268850, -0.009341, 0.300339, -0.807020, 0.026652, -0.003576, 0.684834, -0.597860, -0.764561, 0.870744, 0.533619, 0.660329, -0.968149, -0.280245, 0.943932, 0.884999, 0.914227, 0.244758, -0.907812, -0.022848 },
    }
};

void test_convolution()
{
    dahl_arena* scratch_arena = dahl_arena_new();

    // ----------- Forward -----------
    size_t constexpr num_channels = 1;
    dahl_shape4d constexpr input_shape = { .x = 28, .y = 28, .z = num_channels, .t = 1 }; // We test with a one batch input
    dahl_convolution* conv = convolution_init(testing_arena, scratch_arena, input_shape, 6, num_channels);

    dahl_tensor const* img_batch = tensor_init_from(testing_arena, input_shape, (dahl_fp*)&sample);

    dahl_tensor* conv_forward_out = convolution_forward(testing_arena, conv, img_batch);

    dahl_shape4d constexpr expect_shape = { .x = 23, .y = 23, .z = num_channels, .t = 1 };
    dahl_tensor const* expect_forward = tensor_init_from(testing_arena, expect_shape, (dahl_fp*)&expect_conv_forward);

    ASSERT_SHAPE4D_EQUALS(expect_shape, tensor_get_shape(conv_forward_out));
    ASSERT_TENSOR_EQUALS_ROUND(expect_forward, conv_forward_out, 6);

    // ----------- Backward -----------
    dahl_fp const learning_rate = 0.05F;
    
    dahl_tensor const* pool_backward = tensor_init_from(testing_arena, expect_shape, (dahl_fp*)&expect_pool_backward);

    dahl_tensor* conv_backward_out = convolution_backward(testing_arena, conv, pool_backward, learning_rate, img_batch);

    dahl_tensor const* expect_backward = tensor_init_from(testing_arena, input_shape, (dahl_fp*)&expect_conv_backward);

    ASSERT_SHAPE4D_EQUALS(input_shape, tensor_get_shape(conv_backward_out));
    ASSERT_TENSOR_EQUALS_ROUND(expect_backward, conv_backward_out, 6);

    // testing that weights and biases are correctly updated
    dahl_shape3d const expect_filters_shape = { .x = 6, .y = 6, .z = num_channels };
    dahl_shape3d constexpr expect_biases_shape = { .x = 23, .y = 23, .z = num_channels };
    dahl_block const* expect_filters = block_init_from(testing_arena, expect_filters_shape, (dahl_fp*)&expect_conv_filters);
    dahl_block const* expect_biases = block_init_from(testing_arena, expect_biases_shape, (dahl_fp*)&expect_conv_biases);

    ASSERT_SHAPE3D_EQUALS(expect_filters_shape, block_get_shape(conv->filters));
    ASSERT_BLOCK_EQUALS_ROUND(expect_filters, conv->filters, 6);

    ASSERT_SHAPE3D_EQUALS(expect_biases_shape, block_get_shape(conv->biases));
    ASSERT_BLOCK_EQUALS_ROUND(expect_biases, conv->biases, 6);

    dahl_arena_reset(testing_arena);
    dahl_arena_delete(scratch_arena);
}

void test_pool()
{
    size_t constexpr num_channels = 1;
    // ----------- Forward -----------
    dahl_shape4d constexpr input_shape = { .x = 23, .y = 23, .z = num_channels, .t = 1 };
    dahl_pooling* pool = pooling_init(testing_arena, 2, input_shape);
    dahl_tensor* input = tensor_init_from(testing_arena, input_shape, (dahl_fp*)&expect_conv_forward);

    dahl_tensor* pool_forward_out = pooling_forward(testing_arena, pool, input);

    dahl_shape4d constexpr expect_shape = { .x = 11, .y = 11, .z = num_channels, .t = 1 };
    dahl_tensor const* expect_forward = tensor_init_from(testing_arena, expect_shape, (dahl_fp*)&expect_pool_forward);

    ASSERT_SHAPE4D_EQUALS(expect_shape, tensor_get_shape(pool_forward_out));
    ASSERT_TENSOR_EQUALS_ROUND(expect_forward, pool_forward_out, 6);

    dahl_shape4d constexpr expect_mask_shape = { .x = 23, .y = 23, .z = num_channels, .t = 1 };
    dahl_tensor const* expect_mask = tensor_init_from(testing_arena, expect_mask_shape, (dahl_fp*)&expect_pool_mask);

    ASSERT_TENSOR_EQUALS(expect_mask, pool->mask_batch);

    // ----------- Backward -----------
    dahl_tensor* input_backward = tensor_init_from(testing_arena, expect_shape, (dahl_fp*)&expect_dense_backward);

    dahl_tensor* pool_backward_out = pooling_backward(testing_arena, pool, input_backward); 

    dahl_tensor const* expect_backward = tensor_init_from(testing_arena, input_shape, (dahl_fp*)&expect_pool_backward);

    ASSERT_SHAPE4D_EQUALS(input_shape, tensor_get_shape(pool_backward_out));
    ASSERT_TENSOR_EQUALS_ROUND(expect_backward, pool_backward_out, 6);

    // No weights/biases on this layer
    
    dahl_arena_reset(testing_arena);
}

void test_dense()
{
    dahl_arena* scratch_arena = dahl_arena_new();

    // ----------- Forward -----------
    size_t constexpr num_classes = 10;
    size_t constexpr num_channels = 1;
    dahl_shape4d constexpr input_shape = { .x = 11, .y = 11, .z = num_channels, .t = 1 };
    dahl_dense* dense = dense_init(testing_arena, scratch_arena, input_shape, num_classes);
    dahl_tensor const* input = tensor_init_from(testing_arena, input_shape, (dahl_fp*)&expect_pool_forward);

    dahl_matrix* dense_forward_out = dense_forward(testing_arena, dense, input);

    dahl_shape2d constexpr expect_forward_shape = { .x = num_classes, .y = 1 };
    dahl_matrix const* expect_forward = matrix_init_from(testing_arena, expect_forward_shape, (dahl_fp*)&expect_dense_forward);

    ASSERT_MATRIX_EQUALS_ROUND(expect_forward, dense_forward_out, 6);

    // ----------- Backward -----------
    dahl_fp const learning_rate = 0.05F;
    dahl_matrix const* targets = matrix_init_from(testing_arena, expect_forward_shape, (dahl_fp*)&img_targets);
    dahl_matrix* gradient_batch = matrix_init(testing_arena, expect_forward_shape);
    task_vector_cross_entropy_loss_gradient_batch(dense_forward_out, targets, gradient_batch);

    dahl_tensor* dense_backward_out = dense_backward(testing_arena, dense, gradient_batch, input, dense_forward_out, learning_rate);

    dahl_tensor const* expect_backward = tensor_init_from(testing_arena, input_shape, (dahl_fp*)&expect_dense_backward);

    ASSERT_SHAPE4D_EQUALS(input_shape, tensor_get_shape(dense_backward_out));
    ASSERT_TENSOR_EQUALS_ROUND(expect_backward, dense_backward_out, 6);

    // testing that weights and biases are correctly updated
    dahl_shape3d const expect_weighs_shape = { .x = 121, .y = num_classes, .z = num_channels };
    dahl_block const* expect_weights = block_init_from(testing_arena, expect_weighs_shape, (dahl_fp*)&expect_dense_weights);
    dahl_vector const* expect_biases = vector_init_from(testing_arena, num_classes, (dahl_fp*)&expect_dense_biases);

    ASSERT_SHAPE3D_EQUALS(expect_weighs_shape, block_get_shape(dense->weights));
    ASSERT_BLOCK_EQUALS_ROUND(expect_weights, dense->weights, 6);

    ASSERT_VECTOR_EQUALS_ROUND(expect_biases, dense->biases, 6);

    dahl_arena_reset(testing_arena);
    dahl_arena_delete(scratch_arena);
}

void test_layers()
{
    test_convolution();
    test_pool();
    test_dense();
}
