#include "starpu_data_interfaces.h"
#include "tests.h"

#include "../include/dahl_convolution.h"
#include "../src/utils.h"
#include <stdio.h>

// First image of the fashion mnist dataset
static constexpr dahl_fp sample[28][28] = {
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.000000, 0.000000, 0.050980, 0.286275, 0.000000, 0.000000, 0.003922, 0.015686, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.003922, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.011765, 0.000000, 0.141176, 0.533333, 0.498039, 0.243137, 0.211765, 0.000000, 0.000000, 0.000000, 0.003922, 0.011765, 0.015686, 0.000000, 0.000000, 0.011765 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.023529, 0.000000, 0.400000, 0.800000, 0.690196, 0.525490, 0.564706, 0.482353, 0.090196, 0.000000, 0.000000, 0.000000, 0.000000, 0.047059, 0.039216, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.607843, 0.925490, 0.811765, 0.698039, 0.419608, 0.611765, 0.631373, 0.427451, 0.250980, 0.090196, 0.301961, 0.509804, 0.282353, 0.058824 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.000000, 0.270588, 0.811765, 0.874510, 0.854902, 0.847059, 0.847059, 0.639216, 0.498039, 0.474510, 0.478431, 0.572549, 0.552941, 0.345098, 0.674510, 0.258824 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.003922, 0.003922, 0.000000, 0.784314, 0.909804, 0.909804, 0.913725, 0.898039, 0.874510, 0.874510, 0.843137, 0.835294, 0.643137, 0.498039, 0.482353, 0.768627, 0.898039, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.717647, 0.882353, 0.847059, 0.874510, 0.894118, 0.921569, 0.890196, 0.878431, 0.870588, 0.878431, 0.866667, 0.874510, 0.960784, 0.678431, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.756863, 0.894118, 0.854902, 0.835294, 0.776471, 0.705882, 0.831373, 0.823529, 0.827451, 0.835294, 0.874510, 0.862745, 0.952941, 0.792157, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003922, 0.011765, 0.000000, 0.047059, 0.858824, 0.862745, 0.831373, 0.854902, 0.752941, 0.662745, 0.890196, 0.815686, 0.854902, 0.878431, 0.831373, 0.886275, 0.772549, 0.819608, 0.203922 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.023529, 0.000000, 0.388235, 0.956863, 0.870588, 0.862745, 0.854902, 0.796078, 0.776471, 0.866667, 0.843137, 0.835294, 0.870588, 0.862745, 0.960784, 0.466667, 0.654902, 0.219608 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.015686, 0.000000, 0.000000, 0.215686, 0.925490, 0.894118, 0.901961, 0.894118, 0.941176, 0.909804, 0.835294, 0.854902, 0.874510, 0.917647, 0.850980, 0.850980, 0.819608, 0.360784, 0.000000 },
    { 0.000000, 0.000000, 0.003922, 0.015686, 0.023529, 0.027451, 0.007843, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.929412, 0.886275, 0.850980, 0.874510, 0.870588, 0.858824, 0.870588, 0.866667, 0.847059, 0.874510, 0.898039, 0.843137, 0.854902, 1.000000, 0.301961, 0.000000 },
    { 0.000000, 0.011765, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.243137, 0.568627, 0.800000, 0.894118, 0.811765, 0.835294, 0.866667, 0.854902, 0.815686, 0.827451, 0.854902, 0.878431, 0.874510, 0.858824, 0.843137, 0.878431, 0.956863, 0.623529, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.070588, 0.172549, 0.321569, 0.419608, 0.741176, 0.894118, 0.862745, 0.870588, 0.850980, 0.886275, 0.784314, 0.803922, 0.827451, 0.901961, 0.878431, 0.917647, 0.690196, 0.737255, 0.980392, 0.972549, 0.913725, 0.933333, 0.843137, 0.000000 },
    { 0.000000, 0.223529, 0.733333, 0.815686, 0.878431, 0.866667, 0.878431, 0.815686, 0.800000, 0.839216, 0.815686, 0.819608, 0.784314, 0.623529, 0.960784, 0.756863, 0.807843, 0.874510, 1.000000, 1.000000, 0.866667, 0.917647, 0.866667, 0.827451, 0.862745, 0.909804, 0.964706, 0.000000 },
    { 0.011765, 0.792157, 0.894118, 0.878431, 0.866667, 0.827451, 0.827451, 0.839216, 0.803922, 0.803922, 0.803922, 0.862745, 0.941176, 0.313725, 0.588235, 1.000000, 0.898039, 0.866667, 0.737255, 0.603922, 0.749020, 0.823529, 0.800000, 0.819608, 0.870588, 0.894118, 0.882353, 0.000000 },
    { 0.384314, 0.913725, 0.776471, 0.823529, 0.870588, 0.898039, 0.898039, 0.917647, 0.976471, 0.862745, 0.760784, 0.843137, 0.850980, 0.945098, 0.254902, 0.286275, 0.415686, 0.458824, 0.658824, 0.858824, 0.866667, 0.843137, 0.850980, 0.874510, 0.874510, 0.878431, 0.898039, 0.113725 },
    { 0.294118, 0.800000, 0.831373, 0.800000, 0.756863, 0.803922, 0.827451, 0.882353, 0.847059, 0.725490, 0.772549, 0.807843, 0.776471, 0.835294, 0.941176, 0.764706, 0.890196, 0.960784, 0.937255, 0.874510, 0.854902, 0.831373, 0.819608, 0.870588, 0.862745, 0.866667, 0.901961, 0.262745 },
    { 0.188235, 0.796078, 0.717647, 0.760784, 0.835294, 0.772549, 0.725490, 0.745098, 0.760784, 0.752941, 0.792157, 0.839216, 0.858824, 0.866667, 0.862745, 0.925490, 0.882353, 0.847059, 0.780392, 0.807843, 0.729412, 0.709804, 0.694118, 0.674510, 0.709804, 0.803922, 0.807843, 0.450980 },
    { 0.000000, 0.478431, 0.858824, 0.756863, 0.701961, 0.670588, 0.717647, 0.768627, 0.800000, 0.823529, 0.835294, 0.811765, 0.827451, 0.823529, 0.784314, 0.768627, 0.760784, 0.749020, 0.764706, 0.749020, 0.776471, 0.752941, 0.690196, 0.611765, 0.654902, 0.694118, 0.823529, 0.360784 },
    { 0.000000, 0.000000, 0.290196, 0.741176, 0.831373, 0.749020, 0.686275, 0.674510, 0.686275, 0.709804, 0.725490, 0.737255, 0.741176, 0.737255, 0.756863, 0.776471, 0.800000, 0.819608, 0.823529, 0.823529, 0.827451, 0.737255, 0.737255, 0.760784, 0.752941, 0.847059, 0.666667, 0.000000 },
    { 0.007843, 0.000000, 0.000000, 0.000000, 0.258824, 0.784314, 0.870588, 0.929412, 0.937255, 0.949020, 0.964706, 0.952941, 0.956863, 0.866667, 0.862745, 0.756863, 0.749020, 0.701961, 0.713725, 0.713725, 0.709804, 0.690196, 0.650980, 0.658824, 0.388235, 0.227451, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.156863, 0.239216, 0.172549, 0.282353, 0.160784, 0.137255, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
};

// Class of the first sample, here in categorical format
static constexpr dahl_fp img_targets[10] = {
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000
};

static constexpr dahl_fp expect_conv_forward[2][23][23] = {
    {
        { 0.464870, 0.436084, 0.713466, 0.000000, 0.000000, 0.000000, 0.000000, 0.956951, 0.769605, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.411431, 0.416501, 0.872151, 0.499443, 0.808694, 0.000000, 0.000000 },
        { 0.812104, 0.117336, 0.734616, 0.000000, 0.000000, 0.000000, 0.000000, 0.655547, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.436628, 0.000000, 0.000000, 0.618658 },
        { 0.954936, 0.000000, 0.000000, 0.053940, 0.366463, 0.000000, 0.000000, 0.546050, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.258591, 0.000000, 0.978046, 0.051055, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.275288, 0.000000, 0.008780, 0.766518, 0.000000, 0.000000, 0.237514, 0.000000, 0.190605, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.673414, 0.000000, 0.207221, 0.989426, 0.000000, 0.000000, 0.139208, 0.000000, 0.308626, 0.000000, 0.000000, 0.000000, 0.287158, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.231980, 0.232828, 0.000000, 0.356449, 0.000000, 0.671973, 0.397984, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.204305, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.558727, 0.047361, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.082144, 0.241251, 0.000000, 0.557578, 0.808425, 0.587898, 0.335996, 0.231596, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.144065 },
        { 0.000000, 0.334494, 0.000000, 0.000000, 0.856323, 0.822436, 0.449884, 0.000000, 0.000000, 0.000000, 0.000000, 0.031620, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.304786, 0.000000, 0.000000, 0.082538, 0.722334, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.299114, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.103065, 0.000000, 0.000000, 0.000000, 0.000000, 0.364635, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.030976, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.010995, 0.279604, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.006596, 0.070440, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.565649 },
        { 1.343892, 2.505369, 0.265548, 0.493815, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.204690, 0.277272, 0.000000, 0.000000, 0.000000 },
        { 0.399898, 0.000000, 0.621415, 0.994411, 1.984232, 0.413756, 1.447631, 0.243458, 0.260187, 0.010316, 1.424735, 1.276091, 0.090977, 1.018132, 1.519731, 0.623967, 2.097321, 2.039105, 1.627757, 1.372993, 0.751707, 0.000000, 1.419587 },
        { 0.021613, 0.000000, 0.000000, 0.000000, 0.222828, 1.099793, 0.169066, 0.873382, 0.621826, 1.463076, 0.000000, 0.000000, 1.283302, 0.923474, 0.898022, 0.000000, 0.000000, 1.053039, 1.116091, 1.105049, 0.683973, 0.000000, 0.001810 },
    },
    {
        { 0.343168, 0.000000, 0.916219, 0.275164, 0.000000, 0.000000, 0.879745, 0.000000, 0.272763, 0.686613, 0.538463, 1.589147, 0.160657, 0.000000, 0.917371, 0.000000, 0.460156, 0.000000, 0.027609, 0.000000, 0.583187, 0.222469, 0.000000 },
        { 0.234180, 0.000000, 0.000000, 0.792094, 0.356054, 0.691122, 0.000000, 0.000000, 0.000000, 1.448550, 1.790658, 0.042432, 0.113185, 0.000000, 0.865509, 1.640169, 0.742491, 0.718450, 0.000000, 0.171919, 0.011519, 0.657301, 0.000000 },
        { 0.127696, 0.000000, 0.588846, 0.914177, 0.000000, 0.913372, 0.186103, 0.000000, 0.944099, 0.847599, 1.292712, 1.214445, 0.399180, 0.000000, 0.000000, 0.996768, 0.805274, 0.000000, 0.000000, 0.193513, 0.424818, 0.955959, 0.083787 },
        { 0.383044, 0.000000, 0.000000, 0.018633, 0.807525, 0.062643, 0.223506, 0.000000, 0.000000, 1.543851, 0.337031, 0.137661, 0.000000, 0.000000, 0.570990, 1.628806, 0.251121, 1.263085, 0.031741, 1.169013, 1.769546, 1.309024, 0.677191 },
        { 0.704294, 0.891721, 0.839815, 0.000000, 0.000000, 0.000000, 0.329836, 0.926158, 1.540011, 1.577831, 0.939126, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.205676, 0.871643, 1.493929, 0.000000, 0.253020, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.644243, 0.000000, 0.000000, 0.000000, 0.375859, 1.727848, 0.422383, 0.174660, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.254460, 1.130512, 0.000000, 0.000000 },
        { 0.000000, 0.784477, 0.000000, 0.998946, 0.000000, 0.285039, 0.102523, 0.410657, 0.220223, 0.542668, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.080237, 0.189994, 0.320628, 0.000000, 0.475994, 0.000000, 0.000000, 0.288211, 1.597777, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.033134, 0.902215, 0.113690, 0.000000, 0.000000, 0.000000, 0.000000, 1.001955, 0.989820, 1.207893, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.228129, 0.000000, 0.416093, 0.000000, 0.227346, 0.000000, 0.338456, 1.391600, 0.493932, 0.156471, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.507494, 1.550875, 0.492583, 2.409824, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.695918, 1.042904, 0.000000, 1.194989, 1.515852, 0.000000, 1.229974, 1.293735, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.757977, 0.101872, 1.304161, 0.085419, 1.072893, 1.626752, 1.225391, 0.453414, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.113409, 1.195899, 0.871817, 1.061462, 1.192557, 0.134170, 0.443573, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.327862, 0.024505, 0.000000, 0.000000, 0.000000, 0.050349, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    }
};

static constexpr dahl_fp expect_pool_forward[2][11][11] = {
    {
        { 0.812104, 0.734616, 0.000000, 0.956951, 0.769605, 0.000000, 0.000000, 0.000000, 0.416501, 0.872151, 0.808694 },
        { 0.954936, 0.978046, 0.366463, 0.546050, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.673414, 0.989426, 0.766518, 0.237514, 0.308626, 0.000000, 0.287158, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.231980, 0.558727, 0.356449, 0.671973, 0.000000, 0.000000, 0.204305, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.334494, 0.241251, 0.856323, 0.587898, 0.231596, 0.031620, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.304786, 0.082538, 0.722334, 0.000000, 0.000000, 0.299114, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.030976, 0.000000, 0.000000, 0.103065, 0.000000, 0.364635, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.279604, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.006596, 0.070440, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 2.505369, 0.994411, 1.984232, 1.447631, 0.260187, 1.424735, 1.018132, 1.519731, 2.097321, 1.627757, 0.751707 },
    },
    {
        { 0.343168, 0.916219, 0.691122, 0.879745, 1.448550, 1.790658, 0.160657, 1.640169, 0.742491, 0.171919, 0.657301 },
        { 0.383044, 0.914177, 0.913372, 0.223506, 1.543851, 1.292712, 0.399180, 1.628806, 1.263085, 1.169013, 1.769546 },
        { 0.891721, 0.839815, 0.000000, 0.926158, 1.727848, 0.939126, 0.000000, 0.000000, 0.205676, 1.493929, 1.130512 },
        { 0.784477, 0.998946, 0.475994, 0.410657, 1.597777, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.902215, 0.416093, 0.227346, 1.391600, 1.207893, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.042904, 1.194989, 1.515852, 1.550875, 2.409824, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.195899, 1.304161, 1.626752, 1.225391, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.327862, 0.000000, 0.050349, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    }
};

static constexpr dahl_fp expect_pool_mask[2][23][23] = {
{
    { 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000 },
    { 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 1.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    },
    {
        { 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    }
};

static constexpr dahl_fp expect_dense_forward[10] = {
    0.022735, 0.000046, 0.129384, 0.000133, 0.004302, 0.000002, 0.564576, 0.000268, 0.000060, 0.278494
};

static constexpr dahl_fp expect_dense_backward[2][11][11] = {
    {
        { -0.061668, 0.094394, 0.075496, 0.058431, -0.002471, 0.044083, -0.051091, -0.005950, -0.018373, 0.019913, -0.006575    },
        { -0.062352, 0.006854, -0.073504, 0.123459, 0.044758, 0.011641, 0.055061, -0.051832, -0.011567, 0.053728, -0.101878     },
        { 0.057061, 0.064544, 0.029484, -0.029531, 0.046872, -0.011686, 0.014030, 0.005737, 0.104028, -0.059143, 0.053034       },
        { 0.061335, -0.031149, 0.027304, 0.049997, 0.017400, -0.015507, -0.021292, -0.019065, 0.002288, -0.107808, -0.016270    },
        { 0.022635, 0.083701, 0.030086, 0.041118, 0.037755, -0.016120, -0.087351, 0.045511, 0.003368, -0.107421, 0.106764       },
        { -0.011471, -0.098388, -0.000826, 0.037575, -0.045408, -0.043241, 0.002343, -0.038626, -0.030650, 0.073569, 0.025495   },
        { -0.002613, 0.078685, 0.008894, 0.010874, 0.077380, 0.040136, 0.002621, -0.032464, -0.077069, 0.012280, -0.066183      },
        { -0.088397, -0.027378, 0.002760, -0.082409, -0.084783, 0.036319, -0.003538, -0.046332, -0.081138, -0.010282, -0.005967 },
        { -0.099201, -0.104146, 0.071056, 0.045045, -0.052579, 0.002525, 0.000769, -0.064570, 0.039166, -0.037099, -0.011895    },
        { -0.009372, 0.031646, -0.010193, -0.085613, -0.047852, 0.071957, 0.079334, -0.027808, -0.007984, -0.001318, 0.017725   },
        { 0.065517, 0.014423, 0.017346, -0.001749, 0.070225, -0.037624, -0.002558, -0.034669, 0.012932, 0.002207, 0.057088      },
    },
    {
        { -0.052704, -0.061504, -0.029658, -0.087892, 0.095345, -0.001949, 0.092259, -0.028226, 0.121606, -0.071530, 0.038227  },
        { -0.111506, -0.083715, -0.029922, -0.009867, 0.037520, 0.014604, 0.005558, 0.004588, -0.022423, 0.009386, -0.094744   },
        { 0.006069, -0.043189, 0.047115, -0.047395, -0.020203, -0.098246, 0.019461, -0.015187, -0.003179, 0.083194, 0.041441   },
        { 0.011956, 0.052721, -0.001470, -0.013413, 0.030710, -0.023361, -0.047972, -0.065645, -0.073326, 0.054804, -0.009379  },
        { -0.072718, 0.092362, -0.073508, -0.077924, -0.014435, 0.084417, -0.034087, 0.053779, -0.062362, -0.004479, 0.015884  },
        { -0.047591, 0.016183, -0.002212, -0.035578, -0.008996, 0.011783, -0.092083, -0.012497, -0.015365, -0.080986, 0.025744 }, 
        { 0.025016, -0.079327, 0.070830, -0.052240, 0.028700, 0.012059, 0.057002, 0.045035, 0.000923, -0.043386, 0.012632      },
        { 0.015403, 0.052914, -0.046501, -0.023311, -0.034475, 0.066279, -0.022186, 0.029428, 0.057085, 0.020754, -0.026538    },
        { 0.023259, 0.032824, -0.019009, -0.026749, 0.006766, -0.027039, -0.035227, -0.072013, 0.000970, -0.117726, -0.049034  },
        { 0.032314, -0.043031, -0.005578, -0.057794, -0.039087, 0.096821, -0.128827, -0.050041, 0.017967, -0.025790, 0.048681  },
        { 0.072434, -0.086470, 0.038619, 0.044918, -0.073649, 0.007114, -0.075865, 0.006459, -0.091738, -0.012936, 0.036407    },
    }
};

static constexpr dahl_fp expect_dense_weights[10][242] = {
    {
        -0.956425, 0.547774, -0.088720, -0.385061, -0.819421, -0.797883, 0.262437, 0.605732, 0.778842, 0.263920, -0.297672, -0.566858, 0.152102, -0.304316, 0.725398, -0.818905, -0.054136, 0.989636, -0.803226, 0.570628, -0.219620, -0.295440, 0.274327, 0.888286, 0.193703, -0.485180, 0.890298, -0.864671, -0.751021, -0.991278, 0.369688, 0.158241, 0.176945, 0.566653, 0.522401, 0.602691, -0.505894, -0.224142, -0.799343, -0.833538, -0.264958, 0.484503, 0.370570, 0.197838, -0.518156, 0.597980, 0.999201, -0.311696, -0.904152, 0.156411, -0.015616, 0.168675, 0.657318, -0.301655, 0.505358, -0.449829, 0.453828, -0.925688, -0.283470, 0.945966, -0.312593, -0.689393, 0.300222, 0.488101, -0.879331, 0.630938, -0.403662, 0.416380, 0.192430, -0.517641, -0.853204, -0.468103, -0.901733, -0.131449, -0.517153, 0.986791, -0.621389, 0.141567, 0.677206, -0.125958, -0.274199, 0.451484, 0.556467, 0.738830, -0.585898, -0.446726, -0.223908, 0.746143, 0.308538, 0.310843, 0.955007, -0.655402, 0.973818, -0.498038, -0.426644, -0.207561, 0.380860, 0.378682, -0.526909, -0.686307, -0.373984, -0.551909, 0.047862, -0.723533, 0.175636, 0.182090, 0.332009, -0.707046, 0.634465, 0.956850, -0.829300, 0.761828, 0.823231, 0.147078, 0.258106, 0.463010, 0.966467, 0.229839, -0.313371, -0.371029, 0.987834, 0.619388, 0.390322, 0.625676, -0.531624, 0.085835, 0.746813, 0.570396, 0.988377, 0.920755, 0.551188, 0.878745, 0.399049, 0.532130, -0.062479, -0.201027, -0.456188, 0.370075, -0.146947, -0.871515, -0.578724, 0.038832, -0.805471, -0.896172, 0.326942, -0.040533, -0.201026, -0.396230, -0.028291, -0.312239, 0.831346, 0.140830, 0.333500, 0.133668, 0.506963, -0.159110, -0.962510, -0.411276, 0.807160, 0.561560, -0.124210, 0.012623, 0.521446, 0.925144, 0.336925, -0.640292, 0.750576, -0.455655, 0.291961, 0.564726, -0.594552, -0.884804, -0.921822, 0.324733, 0.603334, 0.863541, -0.488505, -0.052810, -0.284993, 0.559286, -0.215474, -0.790016, -0.980694, 0.050115, 0.835071, 0.071984, 0.338838, 0.986495, -0.252969, -0.990008, 0.197517, 0.583698, -0.729528, 0.695875, 0.614189, -0.636094, -0.454988, 0.795212, -0.671905, 0.708495, 0.460300, -0.936448, 0.737267, 0.059803, 0.234443, 0.846242, 0.902990, -0.118142, 0.066311, -0.646868, 0.069354, -0.509889, 0.709071, -0.960024, 0.150428, 0.887651, 0.448999, 0.409877, -0.747178, 0.176353, -0.519306, 0.413720, -0.452534, 0.054816, -0.345879, -0.199345, -0.984645, -0.939574, 0.014334, -0.074541, -0.568117, -0.775495, 0.786291, 0.203381, -0.655052, -0.515090, 0.402328, -0.596655, 0.460672, -0.373707, 0.353154, -0.221783
    },
    {
        0.282285, 0.031513, -0.060955, 0.461381, 0.068246, -0.646188, 0.422247, -0.388007, 0.229303, -0.251657, -0.831908, -0.486494, -0.499782, -0.099130, 0.433252, 0.190734, -0.482270, -0.012157, -0.328302, 0.172296, 0.710414, 0.251086, -0.668054, -0.209960, -0.542190, 0.528987, 0.309928, -0.666677, -0.875681, 0.662645, -0.086720, 0.024472, 0.075626, 0.112214, -0.510168, -0.800477, -0.102996, -0.353242, 0.690655, 0.668405, -0.024818, 0.606942, 0.212873, -0.144455, -0.039426, 0.397488, -0.660479, 0.695136, -0.458589, -0.140034, 0.091862, -0.189338, 0.992073, -0.965906, -0.105781, 0.915573, -0.831704, -0.465344, 0.796134, 0.133131, -0.416899, -0.961706, -0.952580, 0.813483, -0.464192, 0.379926, 0.894028, 0.750911, 0.111844, 0.568828, -0.351128, -0.348224, 0.006916, -0.227409, 0.423367, -0.638609, 0.891159, 0.917644, -0.257156, 0.254908, 0.684644, -0.277403, -0.204097, -0.464772, -0.745131, 0.533566, -0.518001, -0.279092, 0.695358, -0.327966, -0.867041, 0.958991, -0.566890, 0.601939, -0.607762, -0.545394, 0.491680, 0.871078, -0.851111, -0.011718, 0.369450, 0.692502, -0.427074, 0.412369, -0.478094, -0.241156, 0.706910, 0.103334, -0.076782, -0.097846, 0.562120, -0.976949, 0.466037, 0.749578, -0.183876, 0.913390, 0.306580, 0.440777, -0.577486, -0.856086, 0.593481, -0.400713, -0.297389, 0.574191, 0.209321, -0.058714, -0.315277, 0.825243, -0.883689, -0.098463, -0.336118, -0.620892, 0.617745, -0.376353, 0.914816, -0.250809, -0.329681, -0.808689, -0.155570, -0.001241, 0.054916, -0.136333, -0.095617, 0.151508, 0.536397, 0.046870, -0.261824, -0.515215, -0.729432, -0.074798, -0.124007, 0.152544, 0.977128, 0.080758, 0.344112, 0.497589, 0.141952, -0.769223, -0.595499, 0.216873, -0.170701, 0.004412, -0.931506, 0.312093, 0.411196, -0.305184, -0.712498, -0.988891, 0.418961, -0.822325, 0.151647, -0.162102, -0.953837, -0.531167, 0.852056, -0.681232, -0.011784, 0.455282, 0.205271, -0.604227, 0.154265, -0.151670, -0.367139, -0.556390, 0.210209, 0.549173, -0.698629, 0.655454, -0.642601, 0.201801, 0.934661, -0.517415, 0.568678, 0.889734, 0.740073, -0.390417, -0.403372, -0.761102, -0.682648, 0.556611, -0.696206, -0.254712, 0.817059, 0.047300, 0.096788, 0.954317, -0.132135, 0.977893, 0.444430, 0.474762, 0.361588, -0.078841, -0.407265, 0.535470, 0.157434, 0.982769, -0.197864, -0.248473, 0.147648, -0.474584, -0.544874, -0.275885, 0.900634, -0.377821, 0.121405, -0.529565, -0.717762, -0.247953, -0.448348, 0.214939, -0.875503, 0.459421, -0.435189, -0.088292, 0.003667, 0.827273, -0.991777, -0.225550, -0.356936, -0.237474, 0.455954, 0.961334
    },
    {
        -0.375970, 0.298266, 0.992709, 0.428955, 0.710890, 0.941581, -0.596889, -0.729415, -0.593017, -0.149661, -0.660369, -0.477554, -0.978650, 0.494885, 0.481095, -0.607686, -0.665743, -0.680686, -0.420108, -0.526664, -0.999256, 0.278074, -0.498553, 0.196061, 0.563680, 0.675237, -0.720644, -0.240803, 0.866550, 0.132433, 0.192381, -0.205078, 0.646546, 0.516425, -0.996386, 0.197920, 0.511050, -0.591426, 0.483713, -0.100599, -0.133925, -0.271910, -0.928183, 0.552832, 0.248422, -0.143259, -0.425937, 0.298763, -0.234095, 0.138563, -0.858958, -0.225251, 0.812959, 0.380045, 0.604804, 0.344363, -0.256422, 0.592632, -0.129184, 0.979470, 0.831002, 0.818841, 0.470754, 0.328508, 0.933703, -0.934669, 0.803825, 0.163104, 0.976597, 0.913455, 0.023660, 0.320131, 0.874486, 0.464580, -0.059162, 0.381491, -0.566622, -0.146957, -0.318317, 0.742075, -0.942603, 0.044682, 0.836429, 0.363146, -0.750936, 0.394664, -0.534616, -0.054624, -0.628026, -0.412771, 0.963253, 0.577547, -0.994595, 0.567071, -0.199930, -0.564933, -0.986071, 0.888828, 0.817402, -0.635998, 0.528575, -0.342933, -0.745457, -0.472298, 0.916716, 0.060672, 0.679327, -0.409890, 0.362704, -0.986835, 0.284847, -0.705743, 0.160099, 0.094338, 0.845734, 0.546200, 0.761276, -0.438653, 0.286256, 0.879822, -0.795514, 0.084166, 0.579174, -0.148725, -0.471989, 0.504167, 0.685721, 0.030323, 0.803072, 0.826567, -0.857086, 0.024088, -0.264472, -0.126892, -0.372737, -0.756355, 0.947725, -0.642365, -0.335136, 0.469907, 0.924102, 0.563429, -0.187414, -0.460638, -0.720858, -0.640438, -0.661877, -0.197317, -0.127741, 0.477338, -0.329676, 0.666321, -0.075115, -0.807621, -0.098297, -0.215969, -0.254223, 0.634241, 0.373088, 0.430587, 0.381676, 0.671727, -0.735976, 0.968455, -0.190426, 0.361806, -0.679612, -0.798649, -0.337727, 0.161735, 0.883242, 0.457324, 0.157348, 0.577342, 0.186399, 0.625906, -0.079629, 0.610255, -0.166539, -0.679044, 0.023718, 0.876087, -0.069274, 0.458110, 0.279980, -0.840716, -0.998466, -0.301152, 0.389027, -0.688335, -0.886442, 0.144345, -0.610821, -0.779535, 0.334857, 0.132364, 0.498006, 0.064754, 0.682180, 0.973380, 0.143458, 0.126240, -0.112136, -0.297770, -0.304338, -0.078278, -0.298242, -0.154591, 0.977996, 0.685442, -0.391701, -0.672987, 0.826257, 0.456986, -0.260605, 0.472314, -0.244462, -0.546052, 0.025172, -0.858606, 0.828875, 0.519497, 0.159506, 0.036180, 0.608213, 0.450354, -0.539429, -0.889620, 0.861081, -0.874981, -0.776972, -0.525781, -0.945850, -0.378031, -0.915655, -0.300531, -0.173520, -0.871647, -0.494115, -0.470527, 0.629449, -0.102243
    },
    {
        -0.044223, -0.534563, -0.338469, -0.026990, 0.756839, -0.136875, -0.624603, 0.673711, 0.751543, -0.284788, -0.794269, 0.258089, 0.064260, 0.390712, -0.649499, 0.862588, -0.484819, -0.599024, -0.806695, -0.938729, 0.178784, 0.266224, -0.590510, -0.343645, -0.914177, 0.267117, -0.784867, 0.996828, 0.253823, 0.542838, -0.880496, 0.597043, 0.802576, -0.188603, -0.822082, 0.172805, -0.202937, -0.804252, 0.378964, -0.135499, -0.776329, 0.001585, 0.927822, 0.410324, 0.385954, 0.084968, -0.358588, 0.631765, -0.878080, 0.770434, 0.947701, 0.701026, 0.382270, 0.944083, -0.653174, 0.054374, -0.482198, -0.990699, 0.054373, 0.591667, 0.354184, 0.706778, 0.358647, 0.873935, 0.158912, 0.936887, 0.587609, 0.257250, 0.143190, 0.731113, -0.280915, -0.225868, -0.841447, -0.173134, -0.617590, -0.336147, -0.441436, 0.684545, -0.381469, -0.036809, 0.202849, -0.646994, 0.611609, 0.760337, -0.105576, 0.551164, -0.276937, -0.149604, -0.993599, 0.014203, -0.087539, 0.582963, 0.393276, -0.329058, 0.825988, -0.315125, -0.339563, -0.819296, -0.866362, 0.705972, 0.071083, 0.358430, 0.034168, 0.466403, -0.830773, 0.638956, -0.830957, 0.447287, -0.489426, -0.998977, 0.142210, 0.344251, 0.276220, 0.432947, -0.743180, 0.114522, -0.396056, -0.162284, -0.980988, -0.457992, 0.109292, 0.730071, 0.318864, -0.164484, -0.953704, 0.123705, 0.477562, 0.577691, -0.631506, 0.896368, 0.149558, 0.188947, 0.483843, 0.975836, -0.979917, -0.276591, -0.530775, 0.029458, -0.184021, 0.657929, -0.357403, -0.233641, -0.249595, 0.588749, 0.821970, 0.255783, 0.496009, -0.517143, -0.795961, -0.444684, 0.926806, 0.865084, -0.727938, 0.307218, -0.088486, 0.049681, -0.746785, -0.280854, -0.094654, 0.877476, -0.354722, -0.888152, -0.577989, -0.830586, 0.898272, 0.149824, 0.996544, -0.282657, 0.909452, -0.636439, 0.555024, -0.443827, -0.969442, 0.298187, 0.594284, -0.980718, -0.308923, 0.799738, -0.274164, -0.260861, 0.905593, -0.997513, -0.425594, 0.626620, 0.870045, 0.332985, 0.949179, 0.726878, -0.501494, -0.982716, 0.200728, 0.044784, -0.832303, 0.396562, 0.474848, 0.278901, -0.068107, 0.282581, 0.556583, -0.828747, -0.172260, -0.851699, -0.938545, -0.040058, -0.603643, -0.535815, -0.986207, 0.314024, 0.425122, -0.924976, -0.368008, 0.280412, 0.480290, 0.929815, 0.472194, 0.463502, -0.920295, -0.765892, 0.893778, 0.298877, 0.828724, 0.301794, 0.415292, -0.633440, -0.326403, 0.740385, -0.762293, 0.130526, 0.583790, 0.279456, 0.818903, 0.700439, -0.058160, -0.598038, 0.272281, 0.449359, 0.731608, -0.915936, -0.366970, -0.987314, -0.107793, -0.387785
    },
    {
        -0.748513, 0.112652, -0.578651, 0.388250, -0.135100, 0.136752, 0.555041, 0.145181, -0.631714, 0.928309, 0.345676, 0.510192, 0.393619, -0.406045, -0.225237, -0.371518, -0.312132, 0.306007, 0.876310, 0.288338, -0.782987, 0.204637, 0.159865, -0.165371, -0.944375, -0.154902, -0.937947, 0.002716, -0.162642, -0.833013, -0.202575, 0.361581, -0.688717, -0.405495, 0.361853, -0.576429, -0.118932, 0.482880, 0.130877, 0.070377, -0.741907, 0.365288, -0.890387, 0.011429, 0.776749, 0.440878, -0.048991, 0.494026, -0.470056, 0.302716, 0.593356, 0.976767, -0.660197, -0.991070, 0.107877, -0.866315, 0.286728, 0.529617, 0.599600, -0.230139, 0.385497, -0.355688, 0.473486, 0.172166, 0.749254, 0.775451, 0.354022, 0.054884, -0.211865, -0.805292, -0.107406, -0.169527, -0.903196, 0.571252, 0.240222, -0.879152, 0.472414, 0.060201, 0.084565, 0.889435, -0.707254, 0.176430, 0.417097, -0.075491, -0.277269, 0.948713, -0.552383, -0.778810, 0.817400, -0.958375, 0.151454, 0.683347, 0.072367, -0.569773, -0.975917, 0.990752, 0.124089, 0.744441, -0.398497, -0.170165, 0.700716, 0.060440, -0.237119, -0.708679, 0.189311, -0.112141, 0.504581, 0.964635, -0.539037, 0.733880, -0.993659, 0.198101, -0.891857, -0.658920, -0.762502, 0.966045, 0.947910, 0.716279, -0.865811, 0.239535, -0.092061, -0.395852, 0.147180, -0.173588, 0.894863, 0.201160, 0.632046, 0.006177, 0.341842, 0.814193, -0.494127, -0.567601, -0.806809, -0.627126, -0.708909, -0.727650, 0.218353, -0.397588, 0.483961, 0.051788, 0.478559, -0.267363, 0.652289, 0.634551, 0.938570, 0.098580, 0.229045, -0.874804, 0.950046, -0.708432, 0.368548, -0.459894, -0.559600, -0.952545, -0.428600, -0.422410, -0.257367, 0.017832, 0.963211, 0.903890, -0.101190, 0.334544, 0.668636, 0.366120, 0.711183, -0.277677, 0.510621, 0.666661, -0.595028, 0.113708, 0.623530, 0.930750, 0.225850, -0.790571, -0.601002, 0.090929, 0.696908, 0.032422, 0.634751, 0.984235, -0.473172, 0.425698, -0.999474, 0.053946, 0.711550, 0.618053, 0.703803, 0.215940, 0.497366, -0.118784, -0.701024, 0.800589, -0.635150, -0.763494, -0.231604, -0.615901, 0.009688, -0.688474, 0.133934, 0.603634, 0.910099, 0.180593, 0.770489, -0.543557, -0.403096, 0.366280, -0.871983, -0.502021, -0.999907, 0.777067, -0.013277, 0.936235, 0.434566, 0.032127, -0.367129, 0.414042, 0.857448, 0.891132, -0.991193, 0.895821, 0.096995, 0.498382, -0.428971, 0.476111, -0.265918, 0.660389, 0.646145, -0.302160, 0.221333, 0.649240, -0.970049, -0.865690, 0.657917, 0.455434, -0.191511, -0.043399, 0.613356, 0.257484, 0.542185, -0.471205, -0.986772, -0.087298
    },
    {
        0.728218, -0.713628, -0.723747, 0.538012, -0.426150, 0.521292, -0.160524, 0.733177, 0.327981, -0.640542, -0.318357, 0.983665, -0.631620, -0.668645, 0.586464, -0.251309, 0.145402, 0.264233, -0.327805, 0.562944, -0.205947, -0.838022, -0.060963, 0.718506, -0.347775, 0.330281, -0.257074, -0.526673, 0.768816, 0.507086, 0.951261, 0.669961, -0.723332, 0.965812, -0.736438, 0.805092, -0.612993, 0.308856, -0.214313, -0.062899, 0.386410, 0.228219, 0.707126, -0.532178, -0.950210, 0.831221, -0.797659, 0.998133, -0.435376, -0.572127, -0.492701, 0.114199, 0.020333, -0.779649, -0.450417, -0.796735, -0.235728, 0.480311, -0.779846, 0.418795, -0.051752, 0.631526, 0.751197, 0.370401, -0.593605, -0.358387, 0.319747, -0.192000, -0.895640, 0.574727, -0.814197, -0.182883, -0.396415, -0.992778, -0.675682, 0.906317, -0.661588, 0.576845, 0.167503, -0.599357, -0.889774, -0.847414, 0.430329, 0.549601, -0.011063, -0.672026, -0.495789, -0.875184, -0.518103, 0.068465, -0.279535, 0.921220, -0.512625, 0.353907, 0.445312, 0.441236, 0.911009, -0.544608, 0.328064, 0.667308, 0.218537, 0.164386, 0.194243, -0.606529, -0.907532, -0.906132, -0.649776, 0.128189, -0.325417, -0.842528, 0.435361, -0.105815, 0.572413, -0.687708, 0.744632, 0.239604, 0.694349, -0.677494, -0.443559, -0.600938, -0.959017, 0.538157, -0.334421, 0.771193, -0.148441, -0.430567, -0.897484, 0.930171, 0.186805, -0.370375, -0.972894, -0.894604, -0.013968, -0.555835, 0.856121, 0.808617, 0.663843, 0.423930, 0.013119, -0.658102, 0.808843, -0.745362, -0.625051, -0.176225, -0.293412, -0.743292, -0.156578, 0.933549, 0.209994, 0.628073, -0.646157, 0.881253, 0.783464, -0.308264, 0.500305, -0.958144, -0.055035, -0.015476, -0.379039, 0.491942, 0.738301, 0.938757, -0.873131, -0.065426, -0.361690, 0.149240, -0.130189, 0.317848, 0.335676, -0.710237, -0.592478, -0.145130, -0.371887, -0.327599, 0.352307, 0.423376, -0.054775, -0.985487, 0.234439, -0.011031, -0.744411, 0.603977, -0.190765, -0.788254, 0.547936, 0.362423, -0.166873, -0.787927, -0.668159, 0.289686, 0.935067, -0.111073, 0.075196, 0.917749, 0.147473, 0.905765, 0.089052, -0.766485, -0.431567, -0.806257, 0.053231, 0.119918, -0.676233, 0.758864, 0.023371, 0.364857, 0.761612, 0.948281, -0.572491, -0.146442, -0.794810, -0.611848, 0.561949, -0.163678, -0.933071, -0.973020, 0.138615, 0.206406, -0.000783, -0.159240, 0.013819, 0.982592, 0.000028, -0.612238, -0.796903, -0.292482, 0.810887, 0.475575, 0.282662, 0.366353, 0.609188, 0.202035, 0.432312, -0.562652, 0.373709, -0.457249, -0.245989, -0.162958, 0.370714, -0.818535, -0.533876, -0.759331
    },
    {
        -0.017639, 0.715526, 0.874159, 0.511040, 0.421154, 0.231151, 0.124216, -0.288732, -0.516870, -0.887915, -0.188105, 0.005004, -0.826369, -0.725187, 0.935710, 0.702247, -0.718389, 0.250606, -0.503798, 0.075895, 0.480123, -0.782762, -0.102750, -0.105057, -0.819639, -0.378897, -0.037000, -0.559833, -0.212971, -0.217220, 0.767469, -0.102009, 0.339313, 0.077751, 0.115385, 0.769229, 0.459450, 0.201424, -0.624492, 0.178162, -0.291405, 0.445265, -0.942891, 0.187271, -0.290028, 0.303782, 0.321541, -0.544071, 0.758433, -0.506471, -0.775119, 0.473135, -0.829615, -0.798660, 0.978248, 0.895215, -0.534597, -0.599227, -0.346439, -0.632306, -0.189794, 0.692076, 0.343240, -0.176179, 0.855306, 0.978377, 0.959178, 0.866890, -0.126072, -0.242901, 0.642949, 0.373973, -0.480317, -0.654568, -0.755620, -0.462279, -0.223642, -0.457565, 0.388843, -0.669210, -0.316508, -0.874574, 0.098071, -0.064189, -0.407014, -0.329492, 0.446067, 0.227276, -0.674627, -0.753141, 0.168717, 0.374816, -0.369775, 0.958452, 0.465950, 0.002767, -0.276040, -0.057563, -0.618805, -0.600312, 0.428843, 0.075781, -0.633270, -0.801313, 0.184701, 0.738144, -0.769855, 0.745976, 0.945253, 0.898247, 0.326597, 0.190563, 0.772754, -0.988935, 0.371951, 0.418956, 0.512091, 0.672149, 0.795895, 0.451537, 0.030046, -0.341300, -0.309822, -0.943603, -0.794008, 0.659603, 0.735859, 0.734449, 0.103365, 0.914333, -0.305396, -0.284064, -0.839247, -0.970691, 0.433802, -0.627328, -0.622877, -0.274222, 0.052209, -0.182840, 0.048559, 0.966754, -0.703991, -0.314824, 0.422337, 0.287672, 0.565528, 0.544617, -0.531179, 0.046290, 0.941848, -0.434039, 0.635798, 0.482929, 0.914041, 0.535391, 0.504953, -0.762577, -0.217732, -0.012284, 0.302460, -0.367548, -0.869836, -0.276911, 0.434647, -0.365820, 0.995012, -0.937503, -0.504690, -0.332962, 0.087345, -0.385396, 0.376029, -0.798934, 0.220538, -0.227179, 0.108229, 0.390226, -0.516048, -0.383751, 0.986908, 0.322911, -0.539377, 0.626099, 0.682754, -0.457155, 0.823415, 0.360365, -0.993046, 0.784102, -0.977352, -0.732900, -0.610600, 0.066075, 0.797010, 0.068785, 0.188094, 0.780617, -0.655217, 0.767610, 0.362226, -0.104322, 0.067316, 0.385227, 0.630737, -0.266582, -0.189795, -0.689696, 0.125981, -0.922764, -0.201219, 0.713711, -0.383246, -0.116785, -0.901044, -0.368937, -0.109160, -0.449195, -0.941321, -0.233156, 0.008343, -0.176687, 0.499220, -0.998533, -0.622154, 0.548191, -0.912847, -0.212687, -0.756230, -0.330807, 0.213867, 0.920687, -0.173003, -0.499502, -0.204305, -0.686381, -0.232395, -0.410786, 0.729451, -0.356815, 0.330617, 0.174978
    },
    {
        0.166907, 0.539556, -0.717136, 0.580412, -0.570109, -0.254029, 0.870982, 0.857435, -0.486188, -0.287937, 0.406883, 0.450196, 0.108040, 0.487939, 0.712017, 0.682122, 0.050581, -0.802064, 0.092042, 0.698720, -0.883577, -0.405262, -0.706281, -0.829849, -0.806514, -0.911051, 0.816504, 0.349731, -0.168260, -0.363203, -0.500587, -0.759204, 0.267003, 0.318885, 0.943745, -0.021197, 0.970354, 0.581883, -0.689156, -0.869103, -0.529513, 0.709065, 0.141401, 0.270562, -0.896467, 0.189938, -0.679091, 0.948220, 0.510410, -0.305138, -0.284712, 0.281478, 0.752793, -0.931702, -0.275091, 0.937616, 0.580959, -0.150622, -0.705478, 0.032021, 0.054948, -0.998998, -0.171101, 0.680131, -0.214326, -0.135667, -0.311603, 0.754105, -0.280506, 0.506344, 0.486612, 0.360202, -0.090643, 0.789931, -0.932006, -0.398066, 0.043912, 0.720993, -0.344284, -0.896525, -0.386394, 0.057648, -0.449337, -0.762393, -0.497559, 0.285441, -0.712698, -0.051742, -0.156465, 0.599461, -0.663626, -0.075426, -0.394591, -0.922553, -0.197544, -0.297485, 0.851269, 0.281935, -0.166885, -0.030449, 0.313065, -0.648615, -0.961532, 0.829103, 0.542030, 0.206468, -0.426091, -0.913196, -0.078313, -0.559557, 0.654822, -0.859796, -0.212177, -0.806703, 0.186056, -0.043504, -0.153041, 0.524882, -0.392477, 0.232567, 0.782550, 0.140161, 0.720929, 0.029324, -0.889107, -0.075102, 0.445921, -0.050026, -0.076625, 0.037155, 0.693877, 0.761801, -0.772776, -0.961490, -0.640673, 0.099754, 0.633092, -0.631867, -0.293274, -0.153269, -0.250073, -0.726311, 0.163258, 0.354091, 0.633061, -0.502564, 0.471906, -0.173858, 0.551049, -0.409932, -0.329402, 0.614946, -0.749604, -0.316521, 0.908000, 0.225252, 0.698153, 0.854067, -0.727901, 0.101298, -0.599409, -0.687901, -0.868227, -0.315999, 0.997102, -0.611002, -0.235618, -0.289000, 0.472756, 0.028093, 0.075306, 0.538832, -0.204912, -0.634874, -0.601060, -0.293772, -0.340035, 0.271784, 0.843428, 0.627537, -0.313719, -0.167035, 0.464487, 0.534553, 0.061554, -0.318004, 0.815997, -0.910321, -0.249737, -0.953723, 0.281363, -0.051265, 0.229166, 0.829659, 0.910836, 0.913128, 0.695739, -0.773885, -0.536199, -0.097471, -0.871087, 0.734611, -0.272310, 0.707993, 0.190122, 0.372841, -0.909207, 0.092885, 0.747157, -0.210969, -0.379743, 0.882545, 0.204260, -0.235709, -0.964868, -0.338209, 0.748655, -0.523038, -0.717749, 0.543011, -0.892745, 0.379358, -0.339959, 0.940324, -0.394787, 0.745109, 0.275390, 0.850013, -0.284084, 0.220107, -0.418902, 0.084906, -0.631135, -0.188523, -0.838975, 0.256756, -0.647386, 0.533671, -0.108357, 0.074460, -0.625288, -0.277676
    },
    {
        -0.447223, 0.380328, 0.213411, 0.980258, 0.158751, -0.799871, 0.673109, 0.138771, 0.719927, -0.243805, -0.031641, 0.354657, -0.251472, -0.643144, -0.248687, 0.777438, 0.048508, -0.427217, -0.758202, 0.894233, -0.472640, -0.706840, 0.682496, 0.657834, 0.241137, -0.769736, -0.679115, 0.412777, -0.553511, -0.807346, 0.976739, -0.498108, 0.742551, 0.287167, 0.332801, -0.417706, -0.875504, 0.951191, 0.970156, -0.960424, 0.510664, 0.484072, 0.854553, -0.120364, 0.952769, -0.210262, -0.512494, 0.954756, -0.633696, 0.755798, -0.423323, 0.771939, -0.298049, -0.856826, -0.332155, -0.479499, 0.547409, 0.032597, -0.860419, -0.810027, 0.080672, -0.742697, 0.728659, 0.848211, 0.939376, 0.328853, 0.777512, -0.661525, 0.823921, 0.343767, -0.335601, 0.998896, -0.786838, -0.284972, 0.184455, -0.460445, 0.115288, -0.858292, 0.900595, 0.206303, 0.310512, 0.202669, -0.635947, -0.163586, 0.382545, 0.615945, -0.330620, -0.601156, 0.646333, 0.764715, 0.981127, -0.095914, 0.428302, -0.940362, -0.660710, -0.168868, -0.681820, -0.059246, 0.235731, -0.777635, -0.730186, 0.336422, -0.008420, -0.178263, 0.823706, 0.485541, 0.168138, -0.901248, 0.535662, 0.925337, -0.988276, 0.167594, 0.465741, 0.987861, -0.449673, -0.319751, -0.159076, -0.240664, -0.593751, 0.822248, 0.361905, -0.222290, 0.889244, 0.126482, 0.965148, -0.621279, 0.146024, 0.623519, -0.015714, -0.313240, 0.376877, -0.645244, 0.289162, 0.703448, -0.304836, -0.300370, -0.833486, -0.196783, 0.646198, 0.147635, 0.375084, 0.564769, -0.557787, 0.132875, 0.799668, -0.038885, 0.079104, -0.712499, -0.570038, 0.251180, 0.941643, 0.541613, -0.074210, -0.497858, -0.061662, 0.331753, 0.414406, -0.957855, 0.084811, 0.545691, 0.536845, -0.061025, 0.268705, 0.984216, -0.189471, 0.713615, -0.786945, 0.906242, -0.993624, -0.581561, -0.049592, -0.492031, -0.809837, 0.436190, 0.540616, 0.779128, 0.566457, 0.693410, 0.613677, 0.673904, -0.913022, 0.934262, 0.642747, -0.561121, 0.244603, 0.691656, -0.055996, -0.758193, 0.633573, -0.760482, -0.176264, 0.251651, -0.379763, -0.577882, -0.622687, -0.796589, -0.639306, -0.235675, 0.571355, -0.918424, -0.939478, 0.110153, 0.793767, -0.861307, 0.062728, -0.601531, -0.161398, -0.981711, -0.798243, 0.534603, -0.811380, 0.956639, -0.062043, -0.732738, 0.989110, 0.449356, 0.261243, 0.924061, 0.427855, 0.482351, 0.407157, 0.729575, 0.937064, -0.109716, 0.270879, 0.156237, -0.975511, 0.532944, -0.305190, 0.670952, -0.916845, -0.222888, -0.679818, -0.233098, -0.932317, -0.598256, 0.799331, 0.908028, -0.039116, 0.471701, -0.662064, -0.392254
    },
    {
        0.743743, -0.672478, -0.190881, -0.336851, 0.469164, -0.285814, 0.710141, -0.253878, -0.232858, -0.978785, -0.177048, 0.773532, -0.904176, 0.530399, -0.867757, -0.207343, -0.846529, -0.656543, 0.228550, 0.145135, -0.560039, 0.841142, -0.947431, -0.909068, -0.944389, 0.218771, -0.783415, -0.346201, -0.228754, -0.262002, -0.796609, 0.710056, -0.351815, -0.679711, 0.365463, 0.276587, -0.254208, -0.193665, -0.211464, 0.391452, -0.000871, 0.285738, 0.596630, 0.477633, -0.506011, -0.925066, -0.205891, -0.944845, -0.001757, -0.141045, 0.453197, -0.289525, -0.532904, 0.916323, -0.589493, 0.904086, 0.915965, -0.373157, -0.820665, 0.338718, 0.594111, 0.631710, 0.900648, 0.362806, -0.206189, 0.269281, 0.920425, -0.369217, -0.041997, -0.197698, -0.592579, -0.221853, -0.289410, 0.020545, 0.451012, -0.437957, 0.623918, 0.846168, 0.648343, -0.427807, 0.713199, 0.513919, -0.254579, 0.086582, 0.168677, 0.929380, 0.384964, 0.269502, 0.748849, 0.784448, -0.649310, -0.243906, 0.292073, 0.798803, 0.298824, 0.794948, -0.922690, 0.644903, -0.192004, -0.476476, -0.015765, 0.121936, 0.557089, -0.075078, -0.681231, -0.505800, -0.081956, 0.604024, 0.839667, 0.314445, -0.618383, -0.146554, 0.425419, -0.723473, -0.525591, 0.976084, 0.614701, 0.948504, 0.491885, 0.479927, -0.874962, 0.497838, 0.732865, -0.331165, 0.505616, -0.702491, 0.763956, -0.679395, 0.658818, -0.783342, 0.614462, -0.719353, 0.851228, 0.396284, 0.686165, -0.499163, -0.841326, -0.515510, -0.095753, -0.139805, 0.506491, 0.733717, 0.717639, -0.431970, 0.821174, -0.543587, 0.981513, 0.663088, 0.933445, -0.162183, 0.916882, -0.172729, -0.653332, -0.336154, 0.550307, -0.351947, 0.341029, -0.307361, -0.488760, 0.414723, 0.965237, 0.744654, 0.223621, -0.771427, 0.451350, 0.769860, -0.594261, 0.132830, 0.638742, -0.006040, -0.958157, 0.230611, -0.450997, 0.348035, 0.283483, -0.258189, 0.724829, 0.196440, -0.398883, 0.103960, 0.905860, 0.223934, 0.805047, 0.747411, 0.828187, 0.619968, 0.123755, -0.079497, 0.394738, -0.514405, -0.190183, -0.922237, -0.781305, -0.860358, 0.077923, 0.041358, 0.823695, 0.468018, -0.616447, 0.067512, 0.973418, 0.235767, 0.538059, -0.671744, 0.751425, -0.601609, -0.970479, -0.861699, 0.638212, -0.937441, -0.680781, 0.691225, 0.244092, -0.133218, -0.374671, 0.314752, 0.888210, -0.444899, 0.870098, 0.354362, -0.308661, 0.567551, 0.479817, 0.030924, 0.151307, -0.834165, 0.947164, 0.336565, -0.684632, -0.056584, -0.670513, -0.407210, 0.921856, -0.984993, -0.968753, 0.413476, -0.295325, 0.556554, 0.410278, 0.893172, 0.555844, -0.393674
    }
};

static constexpr dahl_fp expect_dense_biases[10] = {
    0.252613, 0.694263, -0.200669, 0.996660, -0.122204, -0.429259, -0.258803, 0.835991, -0.753606, 0.505755
};

static constexpr dahl_fp expect_pool_backward[2][23][23] = {
    {
        { -0.061668, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.058431, -0.002471, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.018373, 0.019913, 0.000000, -0.006575, -0.000000, 0.000000 },
        { -0.061668, -0.000000, 0.094394, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.062352, -0.000000, 0.000000, 0.000000, -0.073504, -0.000000, 0.000000, 0.123459, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 }, 
        { -0.000000, -0.000000, 0.006854, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 }, 
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.029484, 0.000000, -0.000000, -0.029531, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 }, 
        { 0.057061, 0.000000, 0.000000, 0.064544, 0.000000, 0.000000, -0.000000, -0.000000, 0.046872, 0.000000, -0.000000, -0.000000, 0.014030, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 }, 
        { 0.000000, 0.061335, -0.000000, -0.000000, 0.027304, 0.000000, 0.049997, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.021292, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 }, 
        { 0.000000, 0.000000, -0.000000, -0.031149, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 }, 
        { 0.000000, 0.000000, 0.083701, 0.000000, 0.000000, 0.000000, 0.041118, 0.000000, 0.037755, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 }, 
        { 0.000000, 0.022635, 0.000000, 0.000000, 0.030086, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.016120, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 }, 
        { -0.011471, -0.000000, -0.000000, -0.098388, -0.000826, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.043241, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 }, 
        { -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 }, 
        { -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 }, 
        { -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 }, 
        { -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.082409, -0.000000, -0.000000, -0.000000, 0.000000, 0.036319, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 }, 
        { -0.000000, -0.088397, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 }, 
        { -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 }, 
        { -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.002525, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 }, 
        { -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 }, 
        { -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.047852, 0.071957, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 }, 
        { 0.000000, 0.065517, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 }, 
        { 0.000000, 0.000000, 0.000000, 0.014423, 0.017346, 0.000000, -0.001749, -0.000000, 0.070225, 0.000000, -0.037624, -0.000000, -0.000000, -0.002558, -0.034669, -0.000000, 0.012932, 0.000000, 0.002207, 0.000000, 0.057088, 0.000000, 0.000000 }, 
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 }
    },
    {
        { -0.052704, -0.000000, -0.061504, -0.000000, -0.000000, -0.000000, -0.087892, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.092259, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.029658, -0.000000, -0.000000, 0.000000, 0.095345, -0.001949, -0.000000, 0.000000, 0.000000, -0.000000, -0.028226, 0.121606, 0.000000, -0.000000, -0.071530, 0.000000, 0.038227, 0.000000 },
        { -0.000000, -0.000000, -0.000000, -0.083715, -0.000000, -0.029922, -0.000000, -0.000000, 0.000000, 0.000000, 0.014604, 0.000000, 0.005558, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.111506, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.009867, -0.000000, 0.000000, 0.037520, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.004588, -0.000000, -0.022423, 0.000000, 0.009386, -0.094744, -0.000000, 0.000000 },
        { 0.000000, 0.006069, -0.043189, -0.000000, 0.000000, 0.000000, -0.000000, -0.047395, -0.000000, -0.000000, -0.098246, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.003179, 0.000000, 0.083194, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.020203, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.041441, 0.000000, 0.000000 },
        { 0.000000, 0.011956, 0.000000, 0.052721, -0.000000, -0.000000, -0.000000, -0.013413, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, -0.001470, -0.000000, -0.000000, -0.000000, 0.030710, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { -0.000000, -0.072718, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.014435, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.000000, -0.000000, 0.092362, 0.000000, -0.073508, -0.000000, -0.000000, -0.077924, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.035578, -0.000000, -0.008996, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { -0.000000, -0.047591, 0.000000, 0.016183, -0.002212, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.079327, -0.000000, 0.000000, 0.070830, -0.052240, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.025016, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.015403, 0.000000, 0.000000, 0.000000, -0.000000, -0.046501, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000 },
        { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    }
};

static constexpr dahl_fp expect_conv_backward[28][28] = {
    { 0.020046, 0.035884, 0.012224, -0.046011, 0.022996, -0.047716, -0.040722, -0.087501, 0.014086, -0.057370, 0.053399, 0.024494, 0.085880, 0.019695, -0.059431, 0.035598, -0.042864, 0.033018, -0.005741, -0.007362, -0.005688, -0.003268, 0.011478, 0.003747, -0.004383, -0.001664, 0.000000, 0.000000 },
    { 0.033304, -0.002589, -0.051975, -0.082452, -0.035497, 0.064120, -0.016489, 0.040090, 0.029419, 0.070694, -0.082625, -0.033107, 0.044910, 0.025726, -0.016750, -0.025270, 0.145943, -0.041885, -0.090046, 0.013429, -0.070425, 0.096169, -0.025014, 0.002542, 0.009442, -0.014100, 0.006076, 0.000000 },
    { -0.014824, 0.044772, 0.040171, 0.033698, 0.040347, 0.065235, -0.183069, -0.095698, -0.086755, 0.031224, 0.137325, -0.005069, 0.032380, 0.012666, -0.162067, -0.064596, 0.037379, 0.180771, -0.038303, -0.046064, 0.040787, -0.075997, 0.055958, -0.077219, 0.061179, 0.029163, -0.035112, 0.000000 },
    { -0.091170, 0.007340, 0.121457, -0.008067, -0.049781, 0.118693, 0.065704, -0.011111, 0.152528, 0.180720, -0.181583, -0.130678, -0.141485, -0.013240, 0.086825, -0.098847, 0.185365, -0.104072, -0.052575, -0.144584, -0.042619, 0.181194, 0.081457, -0.069289, -0.052103, -0.013628, 0.036782, 0.000000 },
    { -0.086077, -0.024640, 0.043137, -0.094988, 0.015056, 0.154601, 0.112529, 0.119275, 0.092247, 0.106103, -0.137441, -0.110743, -0.161766, 0.002178, -0.099422, -0.067309, -0.012870, 0.057487, -0.013665, 0.027477, 0.102018, -0.184670, 0.120715, -0.095631, -0.054893, 0.120619, -0.011523, 0.000000 },
    { -0.137830, 0.094864, -0.031631, 0.111383, -0.077906, -0.041936, -0.092796, -0.040430, -0.245566, 0.055746, -0.023721, -0.067349, 0.108160, 0.006065, 0.121373, 0.075214, -0.069531, -0.076459, -0.086017, -0.056426, 0.158777, 0.171144, 0.059003, 0.051633, -0.201989, -0.060973, 0.035401, 0.000000 },
    { 0.087896, -0.038670, -0.155676, 0.150110, 0.023341, 0.041110, 0.144934, -0.167062, 0.035347, -0.045397, -0.180698, -0.032225, -0.056041, 0.039917, -0.030518, -0.105324, 0.066349, -0.080532, 0.070832, 0.010698, 0.007397, -0.083087, -0.055971, 0.153026, 0.025241, -0.032555, -0.008936, 0.000000 },
    { 0.119500, 0.098065, 0.101818, 0.156640, 0.075608, -0.229077, -0.081758, 0.053016, -0.068541, 0.133357, -0.009074, -0.039011, -0.018408, 0.034567, -0.059925, 0.035670, 0.017318, 0.011808, 0.022131, -0.030723, 0.070791, -0.004997, -0.037501, 0.137210, -0.063994, -0.047864, 0.000000, 0.000000 },
    { -0.068703, -0.018570, -0.092019, 0.092139, 0.020966, 0.225551, -0.020321, 0.033608, 0.094808, 0.040961, 0.155052, 0.102582, 0.062086, 0.058654, -0.062799, -0.085175, -0.000792, -0.011951, 0.030595, -0.036953, -0.126633, -0.013683, -0.134469, 0.031419, 0.169367, 0.009657, 0.000000, 0.000000 },
    { 0.029595, -0.050496, -0.119745, 0.076204, -0.244041, -0.123830, 0.004256, -0.150839, 0.194090, 0.003469, -0.125899, 0.056657, -0.100461, 0.021847, 0.079457, -0.013173, -0.027180, -0.013249, -0.010302, 0.044362, -0.053748, 0.023081, -0.052911, -0.086737, 0.003786, 0.038377, 0.000000, 0.000000 },
    { -0.032215, -0.008010, 0.191671, 0.105448, 0.052750, -0.081273, -0.046619, -0.229990, -0.216039, 0.076749, 0.103412, -0.069417, 0.157160, -0.070465, -0.022948, 0.016236, 0.026633, 0.011567, -0.002890, 0.000000, 0.022990, -0.019816, 0.023346, -0.009217, -0.024988, -0.009688, 0.000000, 0.000000 },
    { -0.001319, -0.023614, 0.059201, -0.002743, -0.056982, 0.115594, 0.149074, 0.138013, 0.182545, -0.103244, 0.083908, 0.018243, -0.016863, 0.090227, 0.038071, -0.002651, 0.019651, -0.008996, 0.007026, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { -0.006492, -0.000580, -0.089397, 0.056764, 0.055299, -0.210632, 0.029227, 0.008127, 0.130111, 0.008037, 0.036987, -0.131747, -0.006650, -0.047249, -0.045141, 0.028288, -0.008950, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.001376, -0.029510, -0.064793, -0.140424, 0.184647, -0.107692, 0.011958, 0.089100, -0.020391, 0.054396, 0.003523, 0.023910, -0.100518, -0.014301, -0.014937, -0.011747, -0.002188, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.006195, 0.021994, 0.022628, -0.025917, 0.049931, 0.129979, -0.046549, 0.057297, 0.115846, 0.049395, -0.018534, -0.082546, 0.016940, -0.014192, 0.044067, 0.011532, 0.014511, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.014977, 0.133116, 0.114694, 0.144084, 0.017052, -0.192280, -0.144810, 0.006568, 0.008564, 0.147526, 0.099694, 0.075044, -0.025773, 0.000227, -0.046003, -0.019219, -0.020221, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.010262, -0.060597, 0.022091, 0.047566, 0.119963, 0.171713, -0.041070, -0.110768, -0.009730, 0.051424, -0.051060, 0.045410, 0.014139, 0.008405, 0.012659, 0.018784, -0.032275, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { -0.009183, -0.060911, -0.096868, -0.015132, -0.083681, 0.048323, 0.102698, 0.171832, -0.079171, -0.121148, -0.022866, -0.040422, -0.037007, 0.029034, 0.021697, 0.024523, 0.020804, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { -0.005454, 0.014927, 0.060311, -0.072835, -0.048527, -0.039945, -0.068829, 0.021409, 0.102290, 0.019332, 0.019623, 0.007942, 0.008376, -0.027877, -0.021938, -0.029955, 0.003524, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.008545, -0.053213, -0.010668, 0.062277, 0.039415, 0.037844, 0.073312, -0.028250, -0.060828, 0.096451, -0.058970, -0.033825, -0.038753, 0.014203, 0.027654, 0.034861, -0.014228, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.002214, -0.052660, -0.104777, 0.034996, 0.006329, 0.045749, 0.000000, 0.000000, -0.005502, 0.000176, 0.028596, 0.008959, -0.008733, -0.038231, -0.038474, 0.001402, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 },
    { 0.000000, 0.007534, 0.011087, -0.037301, -0.078465, -0.080027, -0.039421, 0.014373, -0.054174, -0.077119, 0.028033, 0.060593, 0.063669, 0.011385, 0.089866, -0.047577, 0.001969, -0.018483, -0.031576, -0.007930, -0.049361, -0.040259, -0.023306, 0.011786, 0.038056, 0.014448, 0.000000, 0.000000 },
    { 0.000000, 0.037080, 0.025507, 0.016821, 0.027272, 0.031780, -0.075498, -0.026840, -0.015337, 0.009302, 0.010312, -0.170117, -0.019776, 0.003429, 0.048322, 0.056994, 0.014722, 0.031021, 0.029125, 0.009800, -0.006131, 0.000776, -0.021984, -0.044823, -0.052637, -0.031784, 0.000000, 0.000000 },
    { 0.000000, -0.007858, -0.063250, 0.062516, 0.053676, 0.051293, 0.044429, 0.012825, 0.035494, -0.013503, 0.020902, 0.062699, 0.000493, -0.080212, -0.101306, 0.029112, -0.001596, -0.008373, -0.011415, 0.036175, 0.039509, 0.011502, 0.014353, 0.017937, 0.029525, -0.050731, 0.000000, 0.000000 },
    { 0.000000, 0.033981, 0.014338, -0.050427, -0.052102, -0.054617, 0.031911, 0.020884, 0.009042, -0.022560, 0.005404, 0.036810, 0.087063, -0.020879, 0.029157, -0.013286, -0.031806, -0.034330, -0.012759, -0.013831, 0.003116, -0.046644, 0.048748, 0.034549, 0.035901, 0.031697, 0.000000, 0.000000 },
    { 0.000000, -0.050145, 0.001633, 0.064062, -0.004235, 0.020756, -0.043365, -0.020911, 0.026485, 0.018687, -0.070380, -0.047162, -0.025453, 0.028934, 0.010078, -0.010793, 0.033885, 0.023877, 0.017557, -0.011348, 0.018132, 0.013033, -0.044111, -0.031153, -0.043425, 0.007748, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, -0.011039, -0.012917, 0.012888, 0.012711, 0.001711, -0.052690, -0.003536, 0.088706, -0.017926, -0.002824, -0.011803, 0.010576, 0.009341, -0.039199, 0.007913, -0.004324, 0.008260, -0.036324, -0.003396, 0.050235, -0.015008, 0.024119, -0.018837, 0.000000, 0.000000 },
    { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 }
};

static constexpr dahl_fp expect_conv_filters[2][6][6] = {
    {
        { -0.336817, 0.414182, -0.257410, 0.857382, 0.021129, -0.772793 },
        { 0.127171, -0.768627, -0.558152, -0.747924, 0.215592, 0.516553 },
        { 0.550322, 0.625493, 0.583545, 0.831968, -0.963271, -0.120532 },
        { -0.885986, 0.518380, 0.348668, 0.231966, 0.390940, 0.564780 },
        { -0.551300, -0.917229, -0.755822, -0.342883, 0.172292, 0.115817 }, 
        { 0.259544, 0.674147, 0.204475, -0.425741, -0.762860, -0.994100 },
    },
    {
        { -0.233790, -0.603005, -0.222344, 0.563326, -0.476902, 0.557736 },
        { 0.922980, 0.559598, -0.882905, -0.848427, -0.617869, -0.350329 },
        { -0.305623, 0.900350, -0.740504, -0.190775, -0.127501, -0.592204 },
        { 0.960911, 0.132433, -0.646315, -0.681123, -0.588793, 0.669791 },
        { -0.920480, 0.606125, -0.034413, -0.357462, 0.753816, 0.401788 },
        { 0.158721, -0.464278, 0.384941, -0.645978, 0.217619, 0.790258 },
    }
};

static constexpr dahl_fp expect_conv_biases[2][23][23] = {
    {
        { 0.467954, 0.436084, 0.713466, -0.531242, -0.616788, -0.170705, -0.105415, 0.973960, 0.784332, 0.349176, 0.971809, -0.233529, 0.874534, -0.705710, -0.654847, -0.959932, 0.964755, 0.177434, 0.497338, 0.310189, 0.849373, -0.761242, 0.007242 }, 
        { 0.815188, 0.117336, 0.729896, -0.975060, -0.446804, -0.845850, -0.944386, 0.646653, -0.620415, 0.300335, -0.289630, -0.504688, -0.913791, 0.080713, 0.308192, 0.413157, -0.879404, 0.281577, -0.619637, 0.582166, -0.106230, -0.218954, 0.928713 }, 
        { 0.958053, -0.477015, -0.346058, 0.053940, 0.370139, -0.204479, -0.642764, 0.528958, -0.632968, -0.586414, 0.028556, 0.171181, 0.272491, 0.038738, -0.328028, -0.357052, -0.516578, 0.538235, 0.600712, 0.713384, 0.559906, 0.414351, 0.430534 }, 
        { 0.258591, -0.364017, 0.977704, 0.051055, 0.003294, -0.426639, -0.814991, -0.009483, 0.037632, 0.006110, 0.388698, 0.168041, 0.573996, -0.019944, -0.930617, -0.937829, 0.513980, 0.034213, 0.694418, 0.641254, 0.408815, -0.739744, 0.822560 }, 
        { -0.395849, 0.275288, -0.436058, 0.008780, 0.764593, -0.332046, -0.571123, 0.237966, -0.451872, 0.810797, 0.242496, -0.571354, 0.202927, 0.951643, -0.203975, 0.691898, -0.634395, 0.001783, 0.631171, 0.674553, 0.593339, 0.183250, -0.269263 }, 
        { 0.670561, -0.170210, 0.207221, 0.986199, -0.296457, -0.758744, 0.135024, -0.022303, 0.560199, -0.794107, 0.727152, -0.574888, 0.821815, -0.408305, 0.332688, -0.425506, -0.398703, 0.490313, 0.008423, 0.384498, 0.672091, 0.552979, -0.105961 }, 
        { -0.634037, 0.228914, 0.232828, -0.853422, 0.359472, -0.975942, 0.679205, 0.446710, -0.314732, 0.702928, 0.451336, -0.284783, -0.016230, 0.980141, -0.763989, -0.144491, -0.753541, 0.826170, -0.335604, -0.794085, -0.355531, 0.465583, -0.078657 }, 
        { -0.144448, -0.757705, -0.198432, 0.560284, 0.044876, -0.440089, -0.144166, 0.108990, -0.602105, -0.665128, -0.848900, -0.107868, -0.697172, -0.413011, 0.500636, 0.075047, -0.885057, -0.492460, 0.041794, 0.566704, 0.626143, 0.110623, 0.210871 }, 
        { -0.058965, 0.082144, 0.237066, -0.724825, 0.574029, 0.812518, 0.582697, 0.478708, 0.956350, 0.492553, 0.447254, 0.501884, 0.621016, 0.020751, 0.898336, 0.951252, -0.044598, 0.681395, -0.964440, 0.634968, 0.828218, 0.525509, 0.760640 }, 
        { -0.072771, 0.366850, -0.169576, -0.099670, 0.827689, 0.799487, 0.452325, 0.081566, -0.655125, 0.436974, 0.412013, 0.743546, -0.939883, -0.494468, -0.983929, -0.469609, -0.973986, -0.622024, 0.652826, 0.815021, 0.442379, 0.331963, -0.312331 }, 
        { 0.298855, -0.539692, -0.303976, 0.141588, 0.998727, -0.617674, 0.541943, 0.748262, 0.658303, -0.849143, 0.867971, 0.002020, 0.983988, -0.295338, -0.339104, -0.729480, 0.575126, 0.372640, -0.220877, 0.925818, -0.585861, 0.712717, 0.145095 }, 
        { 0.139356, -0.183226, 0.083725, -0.490468, -0.729865, -0.530144, 0.790408, -0.632873, -0.506633, 0.789060, 0.087100, -0.388582, 0.229500, 0.556410, -0.102247, 0.403195, 0.504903, 0.230101, -0.635455, 0.674372, 0.195026, 0.390523, -0.073763 }, 
        { 0.505322, 0.231394, 0.459668, -0.304319, -0.331413, -0.822693, -0.476036, 0.589327, 0.166542, 0.465652, 0.682857, -0.117213, -0.466427, 0.561744, -0.297672, 0.880346, 0.215903, -0.097376, -0.430235, 0.523821, -0.935514, 0.649470, 0.271453 }, 
        { -0.290782, 0.333028, 0.834639, 0.857541, -0.373114, 0.264090, -0.180919, 0.570365, -0.364757, 0.173006, -0.461839, -0.863828, 0.364889, 0.332174, 0.210893, 0.253157, -0.041623, -0.258108, -0.602069, 0.828114, -0.439618, 0.910040, 0.653967 }, 
        { -0.681802, 0.266674, -0.480856, 0.458049, -0.714173, 0.144026, 0.841418, -0.649975, 0.856593, -0.676638, -0.567860, 0.228535, -0.253890, 0.488178, -0.290506, 0.644336, 0.160868, 0.827116, -0.639522, -0.986407, 0.108103, -0.400042, 0.485352 }, 
        { 0.035854, 0.746036, -0.456645, -0.991199, -0.705450, -0.356964, 0.409019, 0.335771, -0.619778, -0.964364, -0.138362, 0.732059, 0.957581, -0.255203, -0.785563, -0.407640, -0.082499, 0.533909, -0.458732, 0.226140, 0.770196, 0.357809, 0.230575 }, 
        { -0.232570, -0.190219, -0.297247, 0.800819, -0.453351, -0.869469, -0.116023, -0.449109, -0.476448, 0.672920, 0.070752, 0.535464, 0.295833, 0.879997, -0.484876, -0.347222, 0.960924, 0.914379, -0.866023, -0.287477, 0.473598, -0.027929, 0.811978 }, 
        { -0.113285, -0.008646, 0.298783, 0.917856, -0.376290, 0.139908, 0.867332, 0.366858, -0.342229, 0.751996, 0.585952, 0.971680, 0.937393, 0.030376, 0.035026, -0.442359, -0.130779, 0.934515, -0.530403, 0.263810, -0.066061, -0.162980, -0.028501 }, 
        { 0.147948, -0.857619, 0.627339, 0.517963, 0.317000, 0.044549, -0.420677, 0.189729, -0.227886, 0.314041, -0.750071, -0.014772, 0.751137, -0.417598, -0.014227, 0.443954, -0.816830, -0.062119, -0.745143, 0.043313, -0.035438, -0.409518, 0.167438 }, 
        { -0.319151, -0.919756, 0.557724, -0.477637, -0.683707, -0.653330, 0.142891, -0.547403, 0.829733, 0.890810, 0.804804, 0.471935, -0.695703, 0.939578, 0.963487, -0.704469, -0.502339, 0.915831, 0.294051, 0.632559, 0.622242, 0.079062, 0.953447 }, 
        { 0.351978, 0.987423, -0.675032, 0.873955, -0.650815, -0.654340, 0.674879, 0.697409, -0.900465, -0.003573, 0.259810, 0.209764, -0.275382, 0.178259, 0.597139, -0.980910, -0.914885, -0.189511, 0.770709, 0.736885, -0.633124, 0.011918, -0.009051 }, 
        { 0.687351, -0.909074, -0.725813, -0.989269, 0.060386, -0.767583, 0.618462, -0.371218, -0.317350, -0.570893, 0.877902, 0.566816, -0.763126, -0.004002, 0.509676, -0.484370, 0.922051, 0.886218, 0.562218, 0.584087, 0.135842, -0.863094, 0.716393 }, 
        { 0.356355, 0.520415, -0.533583, -0.268850, -0.009341, 0.300339, -0.807020, 0.026652, -0.003576, 0.684834, -0.597860, -0.764561, 0.870744, 0.533619, 0.660329, -0.968149, -0.280245, 0.943932, 0.884999, 0.914227, 0.244758, -0.907812, -0.022848 }, 
    },
    {
        { 0.345803, -0.883814, 0.919295, 0.275164, -0.663622, -0.584039, 0.884140, -0.447253, 0.261052, 0.336458, -0.541326, 0.417765, -0.120410, -0.670119, 0.714300, -0.958073, 0.719392, -0.085469, 0.323561, -0.316392, 0.506541, 0.184425, -0.144799 }, 
        { 0.234180, -0.359176, -0.610834, 0.792094, 0.356054, 0.692605, -0.931500, -0.719141, -0.462890, 0.726693, 0.074242, -0.908993, -0.042205, -0.290968, 0.801820, 0.859719, 0.835537, 0.606637, 0.117985, 0.484627, -0.306623, 0.498301, -0.577595 }, 
        { 0.127696, -0.657887, 0.588846, 0.918362, -0.122569, 0.914869, 0.183011, -0.849303, 0.751192, -0.258802, -0.144101, 0.756560, 0.850549, -0.796594, -0.301305, 0.570393, 0.414675, -0.288156, -0.960311, -0.501360, 0.158714, 0.496417, 0.129924 }, 
        { 0.388619, -0.036640, -0.238945, 0.018633, 0.804433, 0.058687, 0.220992, -0.975217, -0.788993, 0.017295, -0.393414, 0.279482, -0.062362, 0.309506, 0.779922, 0.904269, -0.320546, 0.805933, -0.121150, 0.554525, 0.697641, 0.526611, 0.973673 }, 
        { 0.704294, 0.891417, 0.841974, -0.702948, -0.179908, -0.557493, 0.324089, 0.931213, 0.500380, -0.169727, 0.813792, 0.128636, -0.216461, 0.977556, 0.734942, -0.244899, -0.713895, -0.162543, -0.421755, 0.668846, -0.630961, -0.091076, 0.567913 }, 
        { -0.183638, -0.269309, -0.373484, 0.644243, -0.442063, -0.323660, -0.603775, 0.370848, 0.498849, -0.985295, 0.638452, -0.526191, 0.008712, 0.541957, -0.112203, 0.119708, 0.178162, 0.649206, 0.467206, 0.053767, 0.152081, -0.328887, -0.436029 }, 
        { -0.606602, 0.783879, -0.594409, 0.996310, -0.734387, 0.277752, 0.107447, 0.386884, -0.685796, -0.616172, -0.116022, -0.628452, -0.992646, -0.547216, 0.540532, 0.021268, 0.917113, -0.739031, -0.228674, -0.632122, 0.745635, 0.239405, 0.299829 }, 
        { 0.080237, 0.189994, 0.320628, -0.779786, 0.475879, -0.731684, -0.093964, -0.006266, 0.417815, -0.920977, -0.434900, -0.896358, -0.112712, -0.976896, 0.495076, -0.977735, -0.262351, 0.271721, 0.473744, -0.532058, 0.823938, 0.972570, 0.535958 }, 
        { 0.033134, 0.905851, 0.113690, -0.103762, -0.404138, -0.652042, -0.568590, 0.657760, -0.722430, 0.714775, 0.503089, 0.045658, -0.137346, 0.298888, -0.787499, -0.088753, 0.790155, 0.774744, 0.328084, -0.913893, 0.094979, 0.113256, 0.713052 }, 
        { 0.209895, -0.691126, 0.425016, -0.111745, 0.233036, -0.344888, 0.359008, 0.366991, -0.953020, 0.438729, -0.057094, -0.606269, -0.499034, 0.536922, 0.364818, -0.383305, -0.685457, 0.498660, -0.268645, -0.590383, 0.859496, 0.026255, 0.067658 }, 
        { -0.666264, -0.542600, -0.748441, -0.871805, -0.570681, 0.055958, 0.984908, -0.357577, 0.995939, -0.440866, -0.158125, -0.104554, 0.207517, 0.683779, -0.182553, 0.623121, 0.772115, 0.953810, 0.765415, 0.875265, 0.196455, -0.443699, 0.352000 }, 
        { 0.546020, 0.846690, -0.841638, 0.695588, 0.751055, -0.910241, 0.137685, -0.186161, -0.941613, -0.926527, -0.478831, 0.721038, 0.028038, -0.285320, -0.097078, -0.273013, 0.984810, 0.629983, -0.119759, -0.772639, 0.230294, -0.305428, -0.775676 }, 
        { 0.128786, -0.449864, 0.616677, -0.747255, -0.282791, 0.247701, 0.249641, 0.205432, -0.991418, -0.637365, 0.016689, -0.947781, -0.627829, 0.472209, -0.546054, -0.424845, 0.965173, -0.730152, 0.803403, -0.911634, 0.252699, 0.654306, 0.511197 }, 
        { -0.019771, -0.051231, 0.124017, 0.414261, 0.855997, 0.249872, 0.975346, -0.576091, 0.470765, -0.274899, -0.119148, 0.678324, -0.164497, -0.193658, -0.430752, 0.678541, 0.207471, 0.107659, -0.795190, 0.403286, 0.564010, -0.979394, 0.449084 }, 
        { 0.938776, 0.096750, -0.120766, -0.292747, -0.246680, 0.732438, 0.276046, -0.145194, -0.611388, 0.683108, 0.684153, 0.240967, 0.129485, 0.740596, -0.344332, 0.664365, 0.109529, 0.498323, 0.977012, 0.029385, -0.248313, -0.664031, -0.920363 }, 
        { -0.478947, 0.161890, -0.250798, -0.640353, -0.933481, -0.296742, 0.878718, -0.863757, 0.924952, 0.304197, 0.203581, -0.214345, -0.504902, -0.992464, 0.987017, -0.978157, -0.444579, 0.628019, 0.986089, -0.187143, 0.038210, 0.593647, -0.124960 }, 
        { -0.460011, 0.430690, 0.473187, -0.045418, -0.867237, 0.150189, -0.719253, -0.772529, 0.603170, 0.837456, -0.912485, -0.499561, -0.743115, -0.583513, 0.454699, 0.794166, 0.758385, -0.678919, 0.859126, -0.919104, 0.274657, 0.586064, 0.206500 }, 
        { -0.691319, 0.575701, -0.040859, -0.352321, -0.587815, -0.078190, 0.432198, -0.879801, 0.447600, -0.451219, -0.869758, -0.850856, 0.036708, -0.858155, -0.119422, 0.981365, -0.874325, -0.339516, -0.045253, 0.455603, -0.787274, 0.804396, -0.066683 }, 
        { -0.445836, 0.322383, 0.640803, -0.207401, 0.981004, -0.617171, -0.866882, 0.903814, 0.547335, -0.405314, -0.693323, 0.578688, -0.083634, -0.682719, 0.585434, 0.572227, -0.263685, -0.928326, 0.086751, 0.396146, 0.379836, -0.906914, 0.749911 }, 
        { 0.094966, -0.588867, -0.184096, 0.950846, 0.431115, 0.128747, 0.922510, -0.863235, 0.745451, -0.389346, -0.031408, 0.809504, 0.543852, -0.440871, -0.436058, -0.261494, 0.488027, -0.031304, 0.132551, 0.434908, 0.016631, -0.677499, -0.277836 }, 
        { -0.433877, 0.667655, 0.697064, 0.299321, 0.126616, 0.695907, -0.293939, -0.758268, 0.662990, 0.405794, 0.918419, 0.676445, -0.102011, -0.916981, -0.632217, 0.320245, -0.218104, -0.889318, 0.686962, 0.421736, -0.031812, -0.381064, 0.249609 }, 
        { -0.881183, 0.385628, -0.606893, 0.825322, 0.657373, -0.976414, 0.706842, -0.769172, 0.674726, -0.014986, 0.902445, 0.752682, 0.515526, 0.441823, 0.110244, -0.035923, 0.604030, -0.278404, -0.725598, 0.494262, -0.031058, -0.957326, 0.079307 }, 
        { -0.764987, -0.713774, -0.318076, -0.481921, -0.940399, 0.855252, 0.894037, -0.073654, 0.956923, 0.351511, -0.888608, -0.339053, -0.460080, -0.853545, 0.108010, 0.143904, 0.686886, -0.652970, 0.473897, -0.075721, -0.132337, -0.796519, -0.896469 }
    }
};

void test_convolution()
{
    // ----------- Forward -----------
    dahl_shape2d constexpr input_shape = { .x = 28, .y = 28 };
    size_t const num_channels = 2;
    dahl_convolution* conv = convolution_init(input_shape, 6, num_channels);

    dahl_matrix const* img_matrix = matrix_init_from(input_shape, (dahl_fp*)&sample);

    dahl_block* conv_forward_out = convolution_forward(conv, img_matrix);

    dahl_shape3d constexpr expect_shape = { .x = 23, .y = 23, .z = 2 };
    dahl_block const* expect_forward = block_init_from(expect_shape, (dahl_fp*)&expect_conv_forward);

    ASSERT_SHAPE3D_EQUALS(expect_shape, block_get_shape(conv_forward_out));
    ASSERT_BLOCK_EQUALS_ROUND(expect_forward, conv_forward_out, 6);

    // ----------- Backward -----------
    dahl_fp const learning_rate = 0.05F;
    
    dahl_block* input_backward = block_init_from(expect_shape, (dahl_fp*)&expect_pool_backward);

    dahl_matrix* conv_backward_out = convolution_backward(conv, input_backward, learning_rate, img_matrix);

    dahl_matrix const* expect_backward = matrix_init_from(input_shape, (dahl_fp*)&expect_conv_backward);

    ASSERT_SHAPE2D_EQUALS(input_shape, matrix_get_shape(conv_backward_out));
    ASSERT_MATRIX_EQUALS_ROUND(expect_backward, conv_backward_out, 6);

    // testing that weights and biases are correctly updated
    dahl_shape3d const expect_filters_shape = { .x = 6, .y = 6, .z = 2 };
    dahl_block const* expect_filters = block_init_from(expect_filters_shape, (dahl_fp*)&expect_conv_filters);
    dahl_block const* expect_biases = block_init_from(expect_shape, (dahl_fp*)&expect_conv_biases);

    ASSERT_SHAPE3D_EQUALS(expect_filters_shape, block_get_shape(conv->filters));
    ASSERT_BLOCK_EQUALS_ROUND(expect_filters, conv->filters, 6);

    ASSERT_SHAPE3D_EQUALS(expect_shape, block_get_shape(conv->biases));
    ASSERT_BLOCK_EQUALS_ROUND(expect_biases, conv->biases, 6);
}

void test_pool()
{
    // ----------- Forward -----------
    dahl_shape3d constexpr input_shape = { .x = 23, .y = 23, .z = 2 };
    dahl_pooling* pool = pooling_init(2, input_shape);
    dahl_block* input = block_init_from(input_shape, (dahl_fp*)&expect_conv_forward);

    dahl_block* pool_forward_out = pooling_forward(pool, input);

    dahl_shape3d constexpr expect_shape = { .x = 11, .y = 11, .z = 2 };
    dahl_block const* expect_forward = block_init_from(expect_shape, (dahl_fp*)&expect_pool_forward);

    ASSERT_SHAPE3D_EQUALS(expect_shape, block_get_shape(pool_forward_out));
    ASSERT_BLOCK_EQUALS_ROUND(expect_forward, pool_forward_out, 6);

    dahl_shape3d constexpr expect_mask_shape = { .x = 23, .y = 23, .z = 2 };
    dahl_block const* expect_mask = block_init_from(expect_mask_shape, (dahl_fp*)&expect_pool_mask);

    ASSERT_BLOCK_EQUALS(expect_mask, pool->mask);

    // ----------- Backward -----------
    dahl_block* input_backward = block_init_from(expect_shape, (dahl_fp*)&expect_dense_backward);

    dahl_block* pool_backward_out = pooling_backward(pool, input_backward); 

    dahl_block const* expect_backward = block_init_from(input_shape, (dahl_fp*)&expect_pool_backward);

    ASSERT_SHAPE3D_EQUALS(input_shape, block_get_shape(pool_backward_out));
    ASSERT_BLOCK_EQUALS_ROUND(expect_backward, pool_backward_out, 6);

    // No weights/biases on this layer
}

void test_dense()
{
    // ----------- Forward -----------
    size_t const num_classes = 10;
    dahl_shape3d constexpr input_shape = { .x = 11, .y = 11, .z = 2 };
    dahl_dense* dense = dense_init(input_shape, num_classes);
    dahl_block* input = block_init_from(input_shape, (dahl_fp*)&expect_pool_forward);

    dahl_vector* dense_forward_out = dense_forward(dense, input);

    dahl_vector const* expect_forward = vector_init_from(num_classes, (dahl_fp*)&expect_dense_forward);

    ASSERT_VECTOR_EQUALS_ROUND(expect_forward, dense_forward_out, 6);

    // ----------- Backward -----------
    dahl_fp const learning_rate = 0.05F;
    dahl_vector const* targets = vector_init_from(num_classes, (dahl_fp*)&img_targets);
    dahl_vector* gradients = task_vector_cross_entropy_loss_gradient(dense_forward_out, targets);

    dahl_block* dense_backward_out = dense_backward(dense, gradients, learning_rate);

    dahl_block const* expect_backward = block_init_from(input_shape, (dahl_fp*)&expect_dense_backward);

    ASSERT_SHAPE3D_EQUALS(input_shape, block_get_shape(dense_backward_out));
    ASSERT_BLOCK_EQUALS_ROUND(expect_backward, dense_backward_out, 6);

    // testing that weights and biases are correctly updated
    dahl_shape2d const expect_weighs_shape = { .x = 242, .y = num_classes };
    dahl_matrix const* expect_weights = matrix_init_from(expect_weighs_shape, (dahl_fp*)&expect_dense_weights);
    dahl_vector const* expect_biases = vector_init_from(num_classes, (dahl_fp*)&expect_dense_biases);

    ASSERT_SHAPE2D_EQUALS(expect_weighs_shape, matrix_get_shape(dense->weights));
    ASSERT_MATRIX_EQUALS_ROUND(expect_weights, dense->weights, 6);

    ASSERT_VECTOR_EQUALS_ROUND(expect_biases, dense->biases, 6);
}



void test_layers()
{
    test_convolution();
    test_pool();
    test_dense();
}
